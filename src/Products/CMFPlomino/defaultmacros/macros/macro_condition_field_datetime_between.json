{
    "design": {
        "resources": {},
        "macro_condition_field_datetime_between": {
            "id": "macro_condition_field_datetime_between",
            "type": "PlominoForm",
            "title": "Is date in range",
            "params": {
                "form_method": "Auto",
                "dynamic_document_title": false,
                "store_dynamic_document_title": false,
                "hide_default_actions": false,
                "isPage": false,
                "isSearchForm": false,
                "search_view": null,
                "resources_js": null,
                "resources_css": null,
                "title": "Is date in range",
                "description": "",
                "helpers": [],
                "ajax_load": null,
                "ajax_include_head": null
            },
            "elements": {
                "field_name": {
                    "id": "field_name",
                    "type": "PlominoField",
                    "title": "Field name",
                    "params": {
                        "field_type": "SELECTION",
                        "mandatory": false,
                        "field_mode": "EDITABLE",
                        "isDynamicField": false,
                        "to_be_indexed": false,
                        "index_type": "DEFAULT",
                        "read_template": null,
                        "edit_template": null,
                        "title": "Field name",
                        "description": "",
                        "helpers": [
                            [
                                {
                                    "selectionlistformula": "\ndefaultitems = ['Select...|']\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return defaultitems # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form : {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields(includesubforms=True):\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\nif ctype == 'PlominoField':\n    current_form_items = ['Current field |%s' % '@@CURRENT_FIELD']\nelse:\n    current_form_items = defaultitems\ncurrent_form_items += get_fields(editform, current_form_name)\ncurrent_forms = editform.getSubforms() +[editform.id]\nother_form_items = [] \nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\" and not other_form.id in current_forms:\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n",
                                    "include_other": true,
                                    "Form": "macro_field_selection_db_elements",
                                    "title": "Select from Fields",
                                    "element_type": "Fields",
                                    "_macro_id_": "macro_field_selection_db_elements_3"
                                }
                            ]
                        ],
                        "ajax_load": null,
                        "ajax_include_head": null,
                        "widget": "SELECT",
                        "selectionlist": null,
                        "separator": null
                    }
                },
                "formula": {
                    "id": "formula",
                    "type": "PlominoField",
                    "title": "Formula",
                    "params": {
                        "field_type": "TEXT",
                        "mandatory": false,
                        "field_mode": "COMPUTEDONSAVE",
                        "isDynamicField": false,
                        "to_be_indexed": false,
                        "index_type": "DEFAULT",
                        "read_template": null,
                        "edit_template": null,
                        "title": "Formula",
                        "description": "",
                        "helpers": null,
                        "ajax_load": null,
                        "ajax_include_head": null,
                        "widget": "HIDDEN",
                        "size": null,
                        "preserve_carriage_returns": false
                    }
                },
                "max_datetime": {
                    "id": "max_datetime",
                    "type": "PlominoField",
                    "title": "Pick a maximum date",
                    "params": {
                        "field_type": "DATETIME",
                        "mandatory": false,
                        "field_mode": "EDITABLE",
                        "isDynamicField": false,
                        "to_be_indexed": false,
                        "index_type": "DEFAULT",
                        "read_template": null,
                        "edit_template": null,
                        "title": "Pick a maximum date",
                        "description": "",
                        "helpers": null,
                        "ajax_load": null,
                        "ajax_include_head": null,
                        "widget": "JQUERY",
                        "format": "%d %B %Y",
                        "startingyear": "1900"
                    }
                },
                "max_hidewhen": {
                    "id": "max_hidewhen",
                    "type": "PlominoHidewhen",
                    "title": "max_hidewhen",
                    "params": {
                        "isDynamicHidewhen": true,
                        "isResetOnHide": false,
                        "title": "max_hidewhen",
                        "description": "",
                        "helpers": [
                            [
                                {
                                    "Form": "macro_condition_field_got_substring",
                                    "_macro_id_": "macro_condition_field_got_substring_1",
                                    "field_compare": "in",
                                    "field_name": "max_option",
                                    "field_value": "pick",
                                    "formula": "\nfield_name = \"\"\"max_option\"\"\"\nfield_value = \"\"\"pick\"\"\"\nif not plominoContext.hasItem(field_name):\n    return False\nfield_result = plominoContext.getItem(field_name)\nif field_name != 'Form':\n    form = plominoContext.getForm()\n    field = getattr(form, field_name)\n    if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\n        field_result = form.computeFieldValue(field_name, plominoContext)\nresult = field_value in str(field_result)\nreturn result\n    ",
                                    "title": "\"max_option\" in pick ",
                                    "value_type": "text"
                                },
                                {
                                    "Form": "macro_hidewhen_show",
                                    "_macro_id_": "macro_hidewhen_show_1",
                                    "formula": "\nreturn False\n",
                                    "title": "Show"
                                }
                            ],
                            [
                                {
                                    "Form": "macro_hidewhen_hide",
                                    "_macro_id_": "macro_hidewhen_hide_1",
                                    "formula": "\nreturn True\n",
                                    "title": "Hide"
                                }
                            ]
                        ],
                        "ajax_load": null,
                        "ajax_include_head": null
                    }
                },
                "max_option": {
                    "id": "max_option",
                    "type": "PlominoField",
                    "title": "Maximum date option",
                    "params": {
                        "field_type": "SELECTION",
                        "mandatory": true,
                        "field_mode": "EDITABLE",
                        "isDynamicField": false,
                        "to_be_indexed": false,
                        "index_type": "DEFAULT",
                        "read_template": null,
                        "edit_template": null,
                        "title": "Maximum date option",
                        "description": "",
                        "helpers": null,
                        "ajax_load": null,
                        "ajax_include_head": null,
                        "widget": "RADIO",
                        "selectionlist": [
                            "Now (value is past)|now",
                            "Pick a date|pick",
                            "Any time in the past|any"
                        ],
                        "separator": null
                    }
                },
                "min_datetime": {
                    "id": "min_datetime",
                    "type": "PlominoField",
                    "title": "Pick a minimum date",
                    "params": {
                        "field_type": "DATETIME",
                        "mandatory": false,
                        "field_mode": "EDITABLE",
                        "isDynamicField": false,
                        "to_be_indexed": false,
                        "index_type": "DEFAULT",
                        "read_template": null,
                        "edit_template": null,
                        "title": "Pick a minimum date",
                        "description": "",
                        "helpers": null,
                        "ajax_load": null,
                        "ajax_include_head": null,
                        "widget": "JQUERY",
                        "format": "%d %B %Y",
                        "startingyear": "1900"
                    }
                },
                "min_hidewhen": {
                    "id": "min_hidewhen",
                    "type": "PlominoHidewhen",
                    "title": "min_hidewhen",
                    "params": {
                        "isDynamicHidewhen": true,
                        "isResetOnHide": false,
                        "title": "min_hidewhen",
                        "description": "",
                        "helpers": [
                            [
                                {
                                    "Form": "macro_condition_field_got_substring",
                                    "_macro_id_": "macro_condition_field_got_substring_1",
                                    "field_compare": "in",
                                    "field_name": "min_option",
                                    "field_value": "pick",
                                    "formula": "\nfield_name = \"\"\"min_option\"\"\"\nfield_value = \"\"\"pick\"\"\"\nif not plominoContext.hasItem(field_name):\n    return False\nfield_result = plominoContext.getItem(field_name)\nif field_name != 'Form':\n    form = plominoContext.getForm()\n    field = getattr(form, field_name)\n    if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\n        field_result = form.computeFieldValue(field_name, plominoContext)\nresult = field_value in str(field_result)\nreturn result\n    ",
                                    "title": "\"min_option\" in pick ",
                                    "value_type": "text"
                                },
                                {
                                    "Form": "macro_hidewhen_show",
                                    "_macro_id_": "macro_hidewhen_show_1",
                                    "formula": "\nreturn False\n",
                                    "title": "Show"
                                }
                            ],
                            [
                                {
                                    "Form": "macro_hidewhen_hide",
                                    "_macro_id_": "macro_hidewhen_hide_1",
                                    "formula": "\nreturn True\n",
                                    "title": "Hide"
                                }
                            ]
                        ],
                        "ajax_load": null,
                        "ajax_include_head": null
                    }
                },
                "min_option": {
                    "id": "min_option",
                    "type": "PlominoField",
                    "title": "Minimum date option",
                    "params": {
                        "field_type": "SELECTION",
                        "mandatory": true,
                        "field_mode": "EDITABLE",
                        "isDynamicField": false,
                        "to_be_indexed": false,
                        "index_type": "DEFAULT",
                        "read_template": null,
                        "edit_template": null,
                        "title": "Minimum date option",
                        "description": "",
                        "helpers": null,
                        "ajax_load": null,
                        "ajax_include_head": null,
                        "widget": "RADIO",
                        "selectionlist": [
                            "Now (value is future)|now",
                            "Pick a date|pick",
                            "Any time in the past|any"
                        ],
                        "separator": null
                    }
                }
            }
        }
    },
    "id": "macros"
}