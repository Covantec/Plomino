{
    "design": {
        "dbsettings": {
            "acl": {
                "AnomynousAccessRight": "NoAccess", 
                "AuthenticatedAccessRight": "NoAccess", 
                "SpecificRights": {
                    "specific_deletedocument": "PlominoAuthor"
                }, 
                "UserRoles": {}
            }, 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "datetime_format": "%d %B %Y", 
                "debugMode": false, 
                "description": "", 
                "do_not_list_users": false, 
                "do_not_reindex": false, 
                "exclude_from_nav": true, 
                "fulltextIndex": true, 
                "i18n": null, 
                "import_macros": [
                    "."
                ], 
                "indexAttachments": false, 
                "indexInPortal": false, 
                "isDatabaseTemplate": false, 
                "start_page": null, 
                "title": "Macros"
            }, 
            "version": "2.0"
        }, 
        "macro_action_redirect": {
            "elements": {
                "content": {
                    "id": "content", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nredirect_type_ = doc.getItem('redirect_type')\r\nform_redirect_ = doc.getItem('form_redirect')\r\nview_redirect_ = doc.getItem('view_redirect')\r\nurl_redirect_ = doc.getItem('url_redirect')\r\ncode = ''\r\nif redirect_type_ == 'form':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nform_redirect = \\\"\\\"\\\"{form_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s/%s' % (db.absolute_url(), form_redirect)\r\nreturn targeturl\r\n    \"\"\".format(\r\n    form_redirect=form_redirect_\r\n)\r\nelif redirect_type_ == 'view':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nview_redirect = \\\"\\\"\\\"{view_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s/%s' % (db.absolute_url(), view_redirect)\r\nreturn targeturl\r\n    \"\"\".format(\r\n    view_redirect=view_redirect_\r\n)\r\nelif redirect_type_ == 'url':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nurl_redirect = \\\"\\\"\\\"{url_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s' % url_redirect\r\nreturn targeturl\r\n    \"\"\".format(\r\n    url_redirect=url_redirect_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Content", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Content", 
                    "type": "PlominoField"
                }, 
                "form_hidewhen": {
                    "id": "form_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\r\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"form\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "form", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"form\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "Form hidewhen"
                    }, 
                    "title": "Form hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "form_redirect": {
                    "id": "form_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Forms", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getForms()]", 
                                "title": "Select from Forms"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "\n### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getForms()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Form redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Form redirect", 
                    "type": "PlominoField"
                }, 
                "redirect_type": {
                    "id": "redirect_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "Form|form", 
                            "View|view", 
                            "URL|url"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Redirect type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Redirect type", 
                    "type": "PlominoField"
                }, 
                "url_hidewhen": {
                    "id": "url_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"url\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "url", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"url\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "URL hidewhen"
                    }, 
                    "title": "URL hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "url_redirect": {
                    "id": "url_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "URL redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "URL redirect", 
                    "type": "PlominoField"
                }, 
                "view_hidewhen": {
                    "id": "view_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"view\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "view", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"view\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "View hidewhen"
                    }, 
                    "title": "View hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "view_redirect": {
                    "id": "view_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Views", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getViews()]", 
                                "title": "Select from Views"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "\n### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getViews()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "View redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "View redirect", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_action_redirect", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">redirect_type</span></p>\n<p><span class=\"plominoFieldClass\">redirect_type</span></p>\n<p><span class=\"plominoHidewhenClass\">start:form_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">form_redirect</span></p>\n<p><span class=\"plominoFieldClass\">form_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:form_hidewhen</span></p>\n<p><span class=\"plominoHidewhenClass\">start:view_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">view_redirect</span></p>\n<p><span class=\"plominoFieldClass\">view_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:view_hidewhen</span></p>\n<p><span class=\"plominoHidewhenClass\">start:url_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">url_redirect</span></p>\n<p><span class=\"plominoFieldClass\">url_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:url_hidewhen</span></p>\n<p><span class=\"plominoFieldClass\">content</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Redirect in action"
            }, 
            "title": "Redirect in action", 
            "type": "PlominoForm"
        }, 
        "macro_action_view_csv_download": {
            "elements": {
                "content": {
                    "id": "content", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "view_redirect_ = plominoContext.getItem('view_redirect')\r\ncode = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nlink = \"{{db_url}}/{{view_id}}/exportCSV?displayColumnsTitle=True&separator=%2C\".format(\r\n    db_url=db.absolute_url(),\r\n    view_id=\\\"\\\"\\\"{view_redirect}\\\"\\\"\\\")\r\nreturn link\r\n\"\"\".format(view_redirect=view_redirect_)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Content", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Content", 
                    "type": "PlominoField"
                }, 
                "view_redirect": {
                    "id": "view_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_field_selection_db_elements", 
                                    "_macro_id_": "macro_field_selection_db_elements_1", 
                                    "element_type": "Views", 
                                    "include_other": null, 
                                    "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\nitems = []\nfor f in editdb.getViews():\n    try:\n        if f.getPortalTypeName() == \"PlominoView\":\n            items.append(item(f))\n    except AttributeError:\n        continue\nreturn items\n", 
                                    "title": "Select from Views"
                                }
                            ]
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\nitems = []\nfor f in editdb.getViews():\n    try:\n        if f.getPortalTypeName() == \"PlominoView\":\n            items.append(item(f))\n    except AttributeError:\n        continue\nreturn items\n\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Select view", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Select view", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_action_view_csv_download", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p>This will download the records from a view in CSV format. The action type should be <em>Redirect formula</em>.</p>\n<p><span class=\"plominoLabelClass\">view_redirect</span></p>\n<p><span class=\"plominoFieldClass\">view_redirect</span></p>\n<p> </p>\n<p><span class=\"plominoFieldClass\">content</span></p>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "CSV download from view"
            }, 
            "title": "CSV download from view", 
            "type": "PlominoForm"
        }, 
        "macro_condition_action": {
            "elements": {
                "action_id": {
                    "id": "action_id", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_field_selection_db_elements", 
                                    "_macro_id_": "macro_field_selection_db_elements_1", 
                                    "element_type": "Actions", 
                                    "include_other": null, 
                                    "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\nitems = ['Save (save)|plomino_save','Close (close)|plomino_close']\nfor f, method_name in editform.getActions(hide=False):\n    try:\n        if f.getPortalTypeName() == \"PlominoAction\":\n            items.append(item(f))\n    except AttributeError:\n        continue\nreturn items\n", 
                                    "title": "Select from Actions"
                                }
                            ]
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\nitems = ['Save (save)|plomino_save','Close (close)|plomino_close']\nfor f, method_name in editform.getActions(hide=False):\n    try:\n        if f.getPortalTypeName() == \"PlominoAction\":\n            items.append(item(f))\n    except AttributeError:\n        continue\nreturn items\n\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "action_id", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "action_id", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\naction_id_ = doc.getItem('action_id')\r\n\r\ncode = \"\"\"\r\naction_id = \\\"\\\"\\\"{action_id}\\\"\\\"\\\"\r\nrequest = plominoContext.REQUEST\r\nif request.get(action_id):\r\n    return True\r\nreturn False\r\n    \"\"\".format(\r\n        action_id=action_id_,\r\n    )\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_condition_action", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "doc = plominoContext\r\naction_id_ = doc.getItem('action_id')\r\ncode = 'Action is'\r\nif action_id_:\r\n    code = \"\"\"Action is {action_id}\"\"\".format(\r\n        action_id=action_id_\r\n    )\r\n    return code\r\n\r\nreturn code", 
                "dynamic_document_title": false, 
                "form_layout": "<p> </p>\n<p>Please select the action this condition to match:</p>\n<p><span class=\"plominoFieldClass\">action_id</span></p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p><span class=\"plominoFieldClass\">formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Action matches"
            }, 
            "title": "Action matches", 
            "type": "PlominoForm"
        }, 
        "macro_condition_field_datetime_between": {
            "elements": {
                "field_name": {
                    "id": "field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_field_selection_db_elements", 
                                    "_macro_id_": "macro_field_selection_db_elements_1", 
                                    "element_type": "Fields", 
                                    "include_other": true, 
                                    "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n", 
                                    "title": "Select from Fields"
                                }
                            ]
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Field name", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name', '')\r\nmin_option_ = doc.getItem('min_option', '')\r\nmax_option_ = doc.getItem('max_option', '')\r\nmin_datetime_ = doc.getItem('min_datetime')\r\nmax_datetime_ = doc.getItem('max_datetime')\r\ncode = \"\"\"\r\nfield_name = '{field_name}'\r\nif not plominoContext.hasItem(field_name):\r\n    return False\r\nfield_result = plominoContext.getItem(field_name)\r\nmin_option = '{min_option}'\r\nmax_option = '{max_option}'\r\nmin_datetime = ''\r\nif min_option == 'pick':\r\n    min_datetime = '{min_datetime}'\r\n    if min_datetime and isinstance(min_datetime, basestring):\r\n        min_datetime = StringToDate(min_datetime)\r\nelif min_option == 'now':\r\n    min_datetime = Now()\r\nmax_datetime = ''\r\nif max_option == 'pick':\r\n    max_datetime = '{max_datetime}'\r\n    if max_datetime and isinstance(max_datetime, basestring):\r\n        max_datetime = StringToDate(max_datetime)\r\nelif max_option == 'now':\r\n    max_datetime = Now()\r\nif min_datetime and not max_datetime:\r\n    return min_datetime < field_result\r\nelif max_datetime and not min_datetime:\r\n    return field_result < max_datetime\r\nelif min_datetime and max_datetime:\r\n    return field_result > min_datetime and field_result < max_datetime\r\nelse:\r\n    return True\r\n\"\"\".format(\r\n    field_name=field_name_,\r\n    min_option=min_option_,\r\n    max_option=max_option_,\r\n    min_datetime=min_datetime_,\r\n    max_datetime=max_datetime_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }, 
                "max_datetime": {
                    "id": "max_datetime", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "DATETIME", 
                        "format": "%d %B %Y", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "startingyear": "1900", 
                        "title": "Pick a maximum date", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "JQUERY"
                    }, 
                    "title": "Pick a maximum date", 
                    "type": "PlominoField"
                }, 
                "max_hidewhen": {
                    "id": "max_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "### START macro_condition_field_got_substring_1 ###\ndef macro_condition_field_got_substring_1():\n    \n    field_name = \"\"\"max_option\"\"\"\n    field_value = \"\"\"pick\"\"\"\n    if not plominoContext.hasItem(field_name):\n        return False\n    field_result = plominoContext.getItem(field_name)\n    if field_name != 'Form':\n        form = plominoContext.getForm()\n        field = getattr(form, field_name)\n        if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\n            field_result = form.computeFieldValue(field_name, plominoContext)\n    result = field_value in str(field_result)\n    return result\n        \n\n### END macro_condition_field_got_substring_1 ###\r\n### START macro_hidewhen_show_1 ###\nif macro_condition_field_got_substring_1():\n    \n    return False\n    \n\n### END macro_hidewhen_show_1 ###\r\n### START macro_hidewhen_hide_1 ###\n\nreturn True\n\n### END macro_hidewhen_hide_1 ###", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_condition_field_got_substring", 
                                    "_macro_id_": "macro_condition_field_got_substring_1", 
                                    "field_compare": "in", 
                                    "field_name": "max_option", 
                                    "field_value": "pick", 
                                    "formula": "\nfield_name = \"\"\"max_option\"\"\"\nfield_value = \"\"\"pick\"\"\"\nif not plominoContext.hasItem(field_name):\n    return False\nfield_result = plominoContext.getItem(field_name)\nif field_name != 'Form':\n    form = plominoContext.getForm()\n    field = getattr(form, field_name)\n    if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\n        field_result = form.computeFieldValue(field_name, plominoContext)\nresult = field_value in str(field_result)\nreturn result\n    ", 
                                    "title": "\"max_option\" in pick ", 
                                    "value_type": "text"
                                }, 
                                {
                                    "Form": "macro_hidewhen_show", 
                                    "_macro_id_": "macro_hidewhen_show_1", 
                                    "formula": "\nreturn False\n", 
                                    "title": "Show"
                                }
                            ], 
                            [
                                {
                                    "Form": "macro_hidewhen_hide", 
                                    "_macro_id_": "macro_hidewhen_hide_1", 
                                    "formula": "\nreturn True\n", 
                                    "title": "Hide"
                                }
                            ]
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "max_hidewhen"
                    }, 
                    "title": "max_hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "max_option": {
                    "id": "max_option", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'pick'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "Now (value is past)|now", 
                            "Pick a date|pick", 
                            "Any time in the past|any"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Maximum date option", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Maximum date option", 
                    "type": "PlominoField"
                }, 
                "min_datetime": {
                    "id": "min_datetime", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "DATETIME", 
                        "format": "%d %B %Y", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "startingyear": "1900", 
                        "title": "Pick a minimum date", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "JQUERY"
                    }, 
                    "title": "Pick a minimum date", 
                    "type": "PlominoField"
                }, 
                "min_hidewhen": {
                    "id": "min_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "### START macro_condition_field_got_substring_1 ###\ndef macro_condition_field_got_substring_1():\n    \n    field_name = \"\"\"min_option\"\"\"\n    field_value = \"\"\"pick\"\"\"\n    if not plominoContext.hasItem(field_name):\n        return False\n    field_result = plominoContext.getItem(field_name)\n    if field_name != 'Form':\n        form = plominoContext.getForm()\n        field = getattr(form, field_name)\n        if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\n            field_result = form.computeFieldValue(field_name, plominoContext)\n    result = field_value in str(field_result)\n    return result\n        \n\n### END macro_condition_field_got_substring_1 ###\r\n### START macro_hidewhen_show_1 ###\nif macro_condition_field_got_substring_1():\n    \n    return False\n    \n\n### END macro_hidewhen_show_1 ###\r\n### START macro_hidewhen_hide_1 ###\n\nreturn True\n\n### END macro_hidewhen_hide_1 ###", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_condition_field_got_substring", 
                                    "_macro_id_": "macro_condition_field_got_substring_1", 
                                    "field_compare": "in", 
                                    "field_name": "min_option", 
                                    "field_value": "pick", 
                                    "formula": "\nfield_name = \"\"\"min_option\"\"\"\nfield_value = \"\"\"pick\"\"\"\nif not plominoContext.hasItem(field_name):\n    return False\nfield_result = plominoContext.getItem(field_name)\nif field_name != 'Form':\n    form = plominoContext.getForm()\n    field = getattr(form, field_name)\n    if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\n        field_result = form.computeFieldValue(field_name, plominoContext)\nresult = field_value in str(field_result)\nreturn result\n    ", 
                                    "title": "\"min_option\" in pick ", 
                                    "value_type": "text"
                                }, 
                                {
                                    "Form": "macro_hidewhen_show", 
                                    "_macro_id_": "macro_hidewhen_show_1", 
                                    "formula": "\nreturn False\n", 
                                    "title": "Show"
                                }
                            ], 
                            [
                                {
                                    "Form": "macro_hidewhen_hide", 
                                    "_macro_id_": "macro_hidewhen_hide_1", 
                                    "formula": "\nreturn True\n", 
                                    "title": "Hide"
                                }
                            ]
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "min_hidewhen"
                    }, 
                    "title": "min_hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "min_option": {
                    "id": "min_option", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'pick'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "Now (value is future)|now", 
                            "Pick a date|pick", 
                            "Any time in the past|any"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Minimum date option", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Minimum date option", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_condition_field_datetime_between", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name', '')\r\nmin_option_ = doc.getItem('min_option', '')\r\nmax_option_ = doc.getItem('max_option', '')\r\nmin_datetime_ = doc.getItem('min_datetime')\r\nmax_datetime_ = doc.getItem('max_datetime')\r\nmin_datetime = ''\r\nif min_option_ == 'pick':\r\n    min_datetime = min_datetime_\r\n    if min_datetime and isinstance(min_datetime, basestring):\r\n        min_datetime = StringToDate(min_datetime)\r\n    if min_datetime:\r\n        min_datetime = DateToString(min_datetime, format='%d %b %Y')\r\nelif min_option_ == 'now':\r\n    min_datetime = 'past'\r\nmax_datetime = ''\r\nif max_option_ == 'pick':\r\n    max_datetime = max_datetime_\r\n    if max_datetime and isinstance(max_datetime, basestring):\r\n        max_datetime = StringToDate(max_datetime)\r\n    if max_datetime:\r\n        max_datetime = DateToString(max_datetime, format='%d %b %Y')\r\nelif max_option_ == 'now':\r\n    max_datetime = 'future'\r\nif min_datetime and not max_datetime:\r\n    return '{min_datetime} < {field_name}'.format(\r\n        min_datetime=min_datetime,\r\n        field_name=field_name_)\r\nelif max_datetime and not min_datetime:\r\n    return '{field_name} < {max_datetime}'.format(\r\n        max_datetime=max_datetime,\r\n        field_name=field_name_)\r\nelif min_datetime and max_datetime:\r\n    return '{min_datetime} < {field_name} < {max_datetime}'.format(\r\n        min_datetime=min_datetime,\r\n        max_datetime=max_datetime,\r\n        field_name=field_name_)\r\nelse:\r\n    return '{field_name} is any date'.format(\r\n        field_name=field_name_)", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">field_name</span></p>\n<p><span class=\"plominoLabelClass\">min_option</span></p>\n<p><span class=\"plominoFieldClass\">min_option</span></p>\n<p><span class=\"plominoHidewhenClass\">start:min_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">min_datetime</span></p>\n<p><span class=\"form-hint\">Enter as date month year.</span></p>\n<p><span class=\"plominoFieldClass\">min_datetime</span></p>\n<p><span class=\"plominoHidewhenClass\">end:min_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">max_option</span></p>\n<p><span class=\"plominoFieldClass\">max_option</span></p>\n<p><span class=\"plominoHidewhenClass\">start:max_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">max_datetime</span></p>\n<p><span class=\"form-hint\">Enter as date month year.</span></p>\n<p><span class=\"plominoFieldClass\">max_datetime</span></p>\n<p><span class=\"plominoHidewhenClass\">end:max_hidewhen</span></p>\n<p><span class=\"plominoFieldClass\">formula</span></p>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Is date in range"
            }, 
            "title": "Is date in range", 
            "type": "PlominoForm"
        }, 
        "macro_condition_field_got_substring": {
            "elements": {
                "field_compare": {
                    "id": "field_compare", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "Contains|in", 
                            "Does not contain|not in"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Comparison", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Comparison", 
                    "type": "PlominoField"
                }, 
                "field_name": {
                    "id": "field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_field_selection_db_elements", 
                                    "_macro_id_": "macro_field_selection_db_elements_1", 
                                    "element_type": "Fields", 
                                    "include_other": true, 
                                    "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n", 
                                    "title": "Select from Fields"
                                }
                            ]
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Field name", 
                    "type": "PlominoField"
                }, 
                "field_value": {
                    "id": "field_value", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Field value", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Field value", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name', '')\r\nfield_compare_ = doc.getItem('field_compare', '')\r\nfield_value_ = doc.getItem('field_value', '')\r\nvalue_type_ = doc.getItem('value_type', '')\r\ncode = ''\r\nif value_type_ == 'text':\r\n    code = \"\"\"\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\nif not plominoContext.hasItem(field_name):\r\n    return False\r\nfield_result = plominoContext.getItem(field_name)\r\nif field_name != 'Form':\r\n    form = plominoContext.getForm()\r\n    field = getattr(form, field_name)\r\n    if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n        field_result = form.computeFieldValue(field_name, plominoContext)\r\nresult = field_value {field_compare} str(field_result)\r\nreturn result\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_compare=field_compare_,\r\n        field_value=field_value_\r\n    )\r\nelif value_type_ == 'regex' and field_compare_ == 'in':\r\n    code = \"\"\"\r\nimport re\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\nif not plominoContext.hasItem(field_name):\r\n    return False\r\nfield_result = plominoContext.getItem(field_name)\r\nif field_name != 'Form':\r\n    form = plominoContext.getForm()\r\n    field = getattr(form, field_name)\r\n    if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n        field_result = form.computeFieldValue(field_name, plominoContext)\r\nresult = re.search(field_value, field_result)\r\nreturn result\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_value=field_value_\r\n    )\r\nelif value_type_ == 'regex' and field_compare_ == 'not in':\r\n    code = \"\"\"\r\nimport re\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\nif not plominoContext.hasItem(field_name):\r\n    return False\r\nfield_result = plominoContext.getItem(field_name)\r\nif field_name != 'Form':\r\n    form = plominoContext.getForm()\r\n    field = getattr(form, field_name)\r\n    if field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n        field_result = form.computeFieldValue(field_name, plominoContext)\r\nresult = re.search(field_value, field_result)\r\nreturn not result\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_value=field_value_\r\n    )\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }, 
                "value_type": {
                    "id": "value_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'text'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "Text|text", 
                            "Regular expression|regex"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Value type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Value type", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_condition_field_got_substring", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name', '')\r\nfield_compare_ = doc.getItem('field_compare', '')\r\nfield_value_ = doc.getItem('field_value', '')\r\nvalue_type_ = doc.getItem('value_type', '')\r\ncode = 'Field contains text'\r\n\r\nif not (field_name_ and field_compare_ and field_value_ and value_type_):\r\n    return code\r\n\r\nvalue_type = 'pattern'\r\nif value_type_ == 'text':\r\n    value_type = ''\r\ncode = '\"{field_name}\" {field_compare} {field_value} {value_type}'.format(\r\n    field_name=field_name_,\r\n    field_compare=field_compare_,\r\n    field_value=field_value_,\r\n    value_type=value_type\r\n)\r\nreturn code", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">field_name</span></p>\n<p><span class=\"plominoLabelClass\">field_compare</span></p>\n<p><span class=\"plominoFieldClass\">field_compare</span></p>\n<p><span class=\"plominoLabelClass\">field_value</span></p>\n<p><span class=\"plominoFieldClass\">field_value</span></p>\n<p><span class=\"plominoLabelClass\">value_type</span></p>\n<p><span class=\"plominoFieldClass\">value_type</span></p>\n<p><span class=\"plominoFieldClass\">formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Field contains text"
            }, 
            "title": "Field contains text", 
            "type": "PlominoForm"
        }, 
        "macro_condition_field_text_validate_chars": {
            "elements": {
                "char_type": {
                    "id": "char_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'chars'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Numerals only|numeric", 
                            "Letters only|alpha", 
                            "Both letters and numerals|alphanumeric", 
                            "Letters, numerals and punctuation|nonwhitespace", 
                            "Regular expression|regex"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Character type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Character type", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nchar_type_ = doc.getItem('char_type')\r\nregex_field_ = doc.getItem('regex_field')\r\ncode = ''\r\nif char_type_ == 'numeric':\r\n    code = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id)\r\nreturn str(value).isdigit()\r\n    \"\"\"\r\nelif char_type_ == 'alpha':\r\n    code = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id)\r\nreturn str(value).isalpha()\r\n    \"\"\"\r\nelif char_type_ == 'alphanumeric':\r\n    code = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id)\r\nreturn str(value).isalnum()\r\n    \"\"\"\r\nelif char_type_ == 'nonwhitespace':\r\n    code = \"\"\"\r\nimport re\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id)\r\nphrase = re.compile('^\\S+$')\r\nreturn phrase.match(value)\r\n    \"\"\"\r\nelif char_type_ == 'regex':\r\n    code = \"\"\"\r\nimport re\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id)\r\nregex_field = \\\"\\\"\\\"{regex_field}\\\"\\\"\\\"\r\nphrase = re.compile(regex_field)\r\nreturn phrase.match(value)\r\n    \"\"\".format(\r\n        regex_field=regex_field_\r\n    )\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }, 
                "regex_field": {
                    "id": "regex_field", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Regular expression", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Regular expression", 
                    "type": "PlominoField"
                }, 
                "regex_hidewhen": {
                    "id": "regex_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\r\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"char_type\"\"\"\nfield_value = \"\"\"regex\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n    \n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "char_type", 
                                "field_value": "regex", 
                                "formula": "\nfield_name = \"\"\"char_type\"\"\"\nfield_value = \"\"\"regex\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n    ", 
                                "title": "Hidewhen based on picking from a selection", 
                                "value_type": "text"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "regex_hidewhen"
                    }, 
                    "title": "regex_hidewhen", 
                    "type": "PlominoHidewhen"
                }
            }, 
            "id": "macro_condition_field_text_validate_chars", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">char_type</span></p>\n<p><span class=\"plominoFieldClass\">char_type</span></p>\n<p><span class=\"plominoHidewhenClass\">start:regex_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">regex_field</span></p>\n<p><span class=\"plominoFieldClass\">regex_field</span></p>\n<p><span class=\"plominoHidewhenClass\">end:regex_hidewhen</span></p>\n<span class=\"plominoFieldClass\">formula</span>\n<p> </p>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Is numeric / alpha / alphanumeric"
            }, 
            "title": "Is numeric / alpha / alphanumeric", 
            "type": "PlominoForm"
        }, 
        "macro_condition_field_text_validate_count": {
            "elements": {
                "count_type": {
                    "id": "count_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'chars'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Characters|chars", 
                            "Words|words"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Count type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Count type", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\ncount_type_ = doc.getItem('count_type')\r\ntotal_count_ = doc.getItem('total_count')\r\nlength_format_ = doc.getItem('length_format')\r\ndefault_code = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id)\r\n\"\"\"\r\nword_code = \"\"\"\r\nadjust_strs = []\r\nfor item in value:\r\n    if item.isalnum() or item.isspace():\r\n        adjust_strs.append(item)\r\n    else:\r\n        adjust_strs.append(' ')\r\nnew_strs = \"\".join(adjust_strs)\r\n\"\"\"\r\nif count_type_ == 'chars':\r\n    if length_format_ == 'fixed':\r\n        code = default_code + \"\"\"\r\nreturn len(value) == {total_count}\r\n        \"\"\".format(\r\n            total_count=total_count_\r\n        )\r\n    elif length_format_ == 'variable':\r\n        code = default_code + \"\"\"\r\nreturn len(value) < {total_count}\r\n        \"\"\".format(\r\n            total_count=total_count_\r\n        )\r\nelif count_type_ == 'words':\r\n    if length_format_ == 'fixed':\r\n        code = default_code + word_code + \"\"\"\r\nreturn len(new_strs.split()) == {total_count}\r\n        \"\"\".format(\r\n            total_count=total_count_\r\n        )\r\n    elif length_format_ == 'variable':\r\n        code = default_code + word_code + \"\"\"\r\nreturn len(new_strs.split()) < {total_count}\r\n        \"\"\".format(\r\n            total_count=total_count_\r\n        )\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }, 
                "length_format": {
                    "id": "length_format", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Fixed length|fixed", 
                            "Variable length up to the total|variable"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Length format", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Length format", 
                    "type": "PlominoField"
                }, 
                "total_count": {
                    "id": "total_count", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": null, 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "number_type": "INTEGER", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Total", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Total", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_condition_field_text_validate_count", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">count_type</span></p>\n<p><span class=\"plominoFieldClass\">count_type</span></p>\n<p><span class=\"plominoLabelClass\">total_count</span></p>\n<p><span class=\"plominoFieldClass\">total_count</span></p>\n<p><span class=\"plominoLabelClass\">length_format</span></p>\n<p><span class=\"plominoFieldClass\">length_format</span></p>\n<span class=\"plominoFieldClass\">formula</span>\n<p> </p>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Chars / words count"
            }, 
            "title": "Chars / words count", 
            "type": "PlominoForm"
        }, 
        "macro_condition_field_text_validate_email": {
            "elements": {
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id)\r\nreturn is_email(value)\r\n\"\"\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_condition_field_text_validate_email", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<span class=\"plominoFieldClass\">formula</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Is email"
            }, 
            "title": "Is email", 
            "type": "PlominoForm"
        }, 
        "macro_condition_number_range_in": {
            "elements": {
                "and_or": {
                    "id": "and_or", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "And|and", 
                            "Or|or"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Combination logic", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Combination logic", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nless_field_name_ = doc.getItem('less_field_name')\r\nless_field_value_ = doc.getItem('less_field_value', '')\r\nand_or_ = doc.getItem('and_or')\r\nmore_field_name_ = doc.getItem('more_field_name')\r\nmore_field_value_ = doc.getItem('more_field_value', '')\r\nif less_field_value_ != '' and more_field_value_ == '':\r\n    code = \"\"\"\r\nless_field_name = \\\"\\\"\\\"{less_field_name}\\\"\\\"\\\"\r\nif not plominoContext.hasItem(less_field_name):\r\n    return False\r\nless_field_result = plominoContext.getItem(less_field_name)\r\nform = plominoContext.getForm()\r\nlf_field = getattr(form, less_field_name)\r\nif lf_field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n    try:\r\n        less_field_result = float(form.computeFieldValue(less_field_name, plominoContext))\r\n    except ValueError:\r\n        less_field_result = 0\r\nresult = less_field_result < {less_field_value}\r\nreturn result\r\n    \"\"\".format(\r\n        less_field_name=less_field_name_,\r\n        less_field_value=less_field_value_\r\n    )\r\nelif more_field_value_ != '' and less_field_value_ == '':\r\n    code = \"\"\"\r\nmore_field_name = \\\"\\\"\\\"{more_field_name}\\\"\\\"\\\"\r\nif not plominoContext.hasItem(more_field_name):\r\n    return False\r\nmore_field_result = plominoContext.getItem(more_field_name)\r\nform = plominoContext.getForm()\r\nmf_field = getattr(form, more_field_name)\r\nif mf_field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n    try:\r\n        more_field_result = float(form.computeFieldValue(more_field_name, plominoContext))\r\n    except ValueError:\r\n        more_field_result = 0\r\nresult = more_field_result > {more_field_value}\r\nreturn result\r\n    \"\"\".format(\r\n        more_field_name=more_field_name_,\r\n        more_field_value=more_field_value_\r\n    )\r\nelse:\r\n    code = \"\"\"\r\nless_field_name = \\\"\\\"\\\"{less_field_name}\\\"\\\"\\\"\r\nif not plominoContext.hasItem(less_field_name):\r\n    return False\r\nless_field_result = plominoContext.getItem(less_field_name)\r\nmore_field_name = \\\"\\\"\\\"{more_field_name}\\\"\\\"\\\"\r\nif not plominoContext.hasItem(more_field_name):\r\n    return False\r\nmore_field_result = plominoContext.getItem(more_field_name)\r\nform = plominoContext.getForm()\r\nlf_field = getattr(form, less_field_name)\r\nif lf_field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n    try:\r\n        less_field_result = float(form.computeFieldValue(less_field_name, plominoContext))\r\n    except ValueError:\r\n        less_field_result = 0\r\nmf_field = getattr(form, more_field_name)\r\nif mf_field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n    try:\r\n        more_field_result = float(form.computeFieldValue(more_field_name, plominoContext))\r\n    except ValueError:\r\n        more_field_result = 0\r\nresult = less_field_result < {less_field_value} {and_or} more_field_result > {more_field_value}\r\nreturn result\r\n    \"\"\".format(\r\n        less_field_name=less_field_name_,\r\n        less_field_value=less_field_value_,\r\n        and_or=and_or_,\r\n        more_field_name=more_field_name_,\r\n        more_field_value=more_field_value_\r\n    )\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }, 
                "less_field_name": {
                    "id": "less_field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_field_selection_db_elements", 
                                    "_macro_id_": "macro_field_selection_db_elements_1", 
                                    "element_type": "Fields", 
                                    "include_other": true, 
                                    "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n", 
                                    "title": "Select from Fields"
                                }
                            ]
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Field name for less than", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Field name for less than", 
                    "type": "PlominoField"
                }, 
                "less_field_value": {
                    "id": "less_field_value", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": null, 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "INTEGER", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Less than this number", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Less than this number", 
                    "type": "PlominoField"
                }, 
                "more_field_name": {
                    "id": "more_field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_field_selection_db_elements", 
                                    "_macro_id_": "macro_field_selection_db_elements_1", 
                                    "element_type": "Fields", 
                                    "include_other": true, 
                                    "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n", 
                                    "title": "Select from Fields"
                                }
                            ]
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Field name for greater than", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Field name for greater than", 
                    "type": "PlominoField"
                }, 
                "more_field_value": {
                    "id": "more_field_value", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": null, 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "INTEGER", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Greater than this number", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Greater than this number", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_condition_number_range_in", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "doc = plominoContext\r\nless_field_name_ = doc.getItem('less_field_name')\r\nless_field_value_ = doc.getItem('less_field_value', '')\r\nand_or_ = doc.getItem('and_or')\r\nmore_field_name_ = doc.getItem('more_field_name')\r\nmore_field_value_ = doc.getItem('more_field_value', '')\r\ncode = \"Number in range\"\r\n\r\nif less_field_value_ != '' and more_field_value_ == '':\r\n    code = \"\"\"{less_field_name} < {less_field_value}\"\"\".format(\r\n        less_field_name=less_field_name_,\r\n        less_field_value=less_field_value_\r\n    )\r\n    return code\r\n\r\nelif more_field_value_ != '' and less_field_value_ == '':\r\n    code = \"\"\"{more_field_name} > {more_field_value}\"\"\".format(\r\n        more_field_name=more_field_name_,\r\n        more_field_value=more_field_value_\r\n    )\r\n    return code\r\n    \r\nelse:\r\n    code = \"\"\"{less_field_name} < {less_field_value} {and_or} {more_field_name} > {more_field_value}\"\"\".format(\r\n        less_field_name=less_field_name_,\r\n        less_field_value=less_field_value_,\r\n        and_or=and_or_,\r\n        more_field_name=more_field_name_,\r\n        more_field_value=more_field_value_\r\n    )\r\n    return code\r\n\r\nreturn code", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">less_field_name</span></p>\n<p><span class=\"plominoFieldClass\">less_field_name</span></p>\n<p><span class=\"plominoLabelClass\">less_field_value</span></p>\n<p><span class=\"plominoFieldClass\">less_field_value</span></p>\n<p><span class=\"plominoLabelClass\">and_or</span></p>\n<p><span class=\"plominoFieldClass\">and_or</span></p>\n<p><span class=\"plominoLabelClass\">more_field_name</span></p>\n<p><span class=\"plominoFieldClass\">more_field_name</span></p>\n<p><span class=\"plominoLabelClass\">more_field_value</span></p>\n<p><span class=\"plominoFieldClass\">more_field_value</span></p>\n<p><span class=\"plominoFieldClass\">formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Number in range"
            }, 
            "title": "Number in range", 
            "type": "PlominoForm"
        }, 
        "macro_condition_selection": {
            "elements": {
                "field_compare": {
                    "id": "field_compare", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Equal to|==", 
                            "Not equal to|!="
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Comparison", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Comparison", 
                    "type": "PlominoField"
                }, 
                "field_name": {
                    "id": "field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            [
                                {
                                    "Form": "macro_field_selection_db_elements", 
                                    "_macro_id_": "macro_field_selection_db_elements_1", 
                                    "element_type": "Fields", 
                                    "include_other": true, 
                                    "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n", 
                                    "title": "Select from Fields"
                                }
                            ]
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = None\nif ctype != 'PlominoView':\n    if ctype == 'PlominoForm':\n        editform = editcontext\n    else:\n        editform = editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm, form_name=''):\n    if form_name:\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\n\ndef get_fields(form_element, form_name):\n    field_items = []\n    for this_form in form_element.getFormFields():\n        try:\n            if this_form.getPortalTypeName() == \"PlominoField\":\n                field_items.append(item(this_form, form_name))\n        except AttributeError:\n            continue\n    return field_items\n\ncurrent_form_name = ''\ncurrent_form_items = ['Form ID|Form']\nif editform:\n    current_form_name = \"{title} ({id})\".format(\n        title=editform.Title(),\n        id=editform.id)\n    current_form_items = get_fields(editform, current_form_name)\n\nother_form_items = []\nfor other_form in editdb.getForms():\n    try:\n        if other_form.getPortalTypeName() == \"PlominoForm\":\n            other_form_name = \"{title} ({id})\".format(\n                title=other_form.Title(),\n                id=other_form.id)\n            if current_form_name != other_form_name:\n                other_form_items += get_fields(other_form, other_form_name)\n    except AttributeError:\n        continue\nreturn current_form_items + other_form_items\n\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Field name", 
                    "type": "PlominoField"
                }, 
                "field_value": {
                    "id": "field_value", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Field value", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Field value", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name')\r\nfield_compare_ = doc.getItem('field_compare')\r\nfield_value_ = doc.getItem('field_value')\r\nvalue_type_ = doc.getItem('value_type')\r\ncode = ''\r\nif value_type_ == 'text':\r\n    code = \"\"\"\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\nif not plominoContext.hasItem(field_name):\r\n    return False\r\nfield_result = plominoContext.getItem(field_name)\r\nresult = str(field_result) {field_compare} field_value\r\nreturn result\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_compare=field_compare_,\r\n        field_value=field_value_\r\n    )\r\nelif value_type_ == 'regex' and field_compare_ == '==':\r\n    code = \"\"\"\r\nimport re\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\npattern = re.compile(field_value)\r\nif not plominoContext.hasItem(field_name):\r\n    return False\r\nfield_result = plominoContext.getItem(field_name)\r\nresult = pattern.match(field_result)\r\nreturn result\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_value=field_value_\r\n    )\r\nelif value_type_ == 'regex' and field_compare_ == '!=':\r\n    code = \"\"\"\r\nimport re\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\npattern = re.compile(field_value)\r\nif not plominoContext.hasItem(field_name):\r\n    return False\r\nfield_result = plominoContext.getItem(field_name)\r\nresult = pattern.match(field_result)\r\nreturn not result\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_value=field_value_\r\n    )\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }, 
                "value_type": {
                    "id": "value_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'text'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Text|text", 
                            "Regular expression|regex"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Value type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Value type", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_condition_selection", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name')\r\nfield_compare_ = doc.getItem('field_compare')\r\nfield_value_ = doc.getItem('field_value')\r\nvalue_type_ = doc.getItem('value_type')\r\ncode = 'Selection matches'\r\nif value_type_ == 'text':\r\n    code = \"\"\"{field_name} {field_compare} {field_value}\"\"\".format(\r\n        field_name=field_name_,\r\n        field_compare=field_compare_,\r\n        field_value=field_value_\r\n    )\r\n    return code\r\n    \r\nelif value_type_ == 'regex' and field_compare_ == '==':\r\n    code = \"\"\"{field_name} match {field_value} pattern\"\"\".format(\r\n        field_name=field_name_,\r\n        field_value=field_value_\r\n    )\r\n    return code\r\n    \r\nelif value_type_ == 'regex' and field_compare_ == '!=':\r\n    code = \"\"\"{field_name} not match {field_value} pattern\"\"\".format(\r\n        field_name=field_name_,\r\n        field_value=field_value_\r\n    )\r\n    return code\r\n\r\nreturn code", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">field_name</span></p>\n<p><span class=\"plominoLabelClass\">field_compare</span></p>\n<p><span class=\"plominoFieldClass\">field_compare</span></p>\n<p><span class=\"plominoLabelClass\">field_value</span></p>\n<p><span class=\"plominoFieldClass\">field_value</span></p>\n<p><span class=\"plominoLabelClass\">value_type</span></p>\n<p><span class=\"plominoFieldClass\">value_type</span></p>\n<p><span class=\"plominoFieldClass\">formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Selection matches"
            }, 
            "title": "Selection matches", 
            "type": "PlominoForm"
        }, 
        "macro_condition_validate_optional_field": {
            "elements": {
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id, '')\r\nreturn value == ''\r\n\"\"\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_condition_validate_optional_field", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p> </p>\n<span class=\"plominoFieldClass\">formula</span>\n<p><br> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Is optional"
            }, 
            "title": "Is optional", 
            "type": "PlominoForm"
        }, 
        "macro_field_autofocus": {
            "elements": {
                "html_attributes_formula": {
                    "id": "html_attributes_formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "return \"\"\"return 'autofocus'\"\"\"", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "html_attributes_formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "html_attributes_formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_autofocus", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p>Focus on this field.</p>\n<p><span class=\"discreet\">Note: If multiple fields have autofocus, autofocus will be given to the first field on the form.</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Set Autofocus"
            }, 
            "title": "Set Autofocus", 
            "type": "PlominoForm"
        }, 
        "macro_field_datetime_now": {
            "elements": {
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"return Now()\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_datetime_now", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<span class=\"plominoFieldClass\">formula</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "DateTime Now"
            }, 
            "title": "DateTime Now", 
            "type": "PlominoForm"
        }, 
        "macro_field_display_sum": {
            "elements": {
                "fields_name": {
                    "id": "fields_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Fields", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editform.getFormFields()]", 
                                "title": "Select from Fields"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "\n### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editform.getFormFields()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Fields name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "MULTISELECT"
                    }, 
                    "title": "Fields name", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfields_name_ = doc.getItem('fields_name', [])\r\ncode = \"\"\"\r\nfields = {fields_name}\r\ntotal = 0\r\nfor field in fields:\r\n    field_value = plominoContext.getItem(field, 0)\r\n    try:\r\n        total += float(field_value)\r\n    except ValueError:\r\n        continue\r\nreturn str(total)\r\n\"\"\".format(\r\n    fields_name=fields_name_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_display_sum", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">fields_name</span></p>\n<p><span class=\"form-hint\">It will sum alll the number in the fields list and display on this field.</span></p>\n<p><span class=\"plominoFieldClass\">fields_name</span></p>\n<p><span class=\"plominoFieldClass\">formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Display total"
            }, 
            "title": "Display total", 
            "type": "PlominoForm"
        }, 
        "macro_field_number_between": {
            "elements": {
                "form_error_message": {
                    "id": "form_error_message", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Error message", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Error message", 
                    "type": "PlominoField"
                }, 
                "max": {
                    "id": "max", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": null, 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "INTEGER", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Maximum", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Maximum", 
                    "type": "PlominoField"
                }, 
                "min": {
                    "id": "min", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": null, 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "INTEGER", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Minimum", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Minimum", 
                    "type": "PlominoField"
                }, 
                "validation_formula": {
                    "id": "validation_formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nmin_ = doc.getItem('min', False)\r\nmax_ = doc.getItem('max', False)\r\nform_error_message_ = doc.getItem('form_error_message')\r\ncode = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id)\r\nmin_value = {min}\r\nmax_value = {max}\r\nform_error_message = \\\"\\\"\\\"{form_error_message}\\\"\\\"\\\"\r\nif min_value != False and max_value == False:\r\n    if value < min_value:\r\n        return form_error_message\r\nelif max_value != False and min_value == False:\r\n    if value > max_value:\r\n        return form_error_message\r\nelif min_value != False and max_value != False:\r\n    if value < min_value or value > max_value:\r\n        return form_error_message\r\n\"\"\".format(\r\n    min=min_,\r\n    max=max_,\r\n    form_error_message=form_error_message_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "validation_formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "validation_formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_number_between", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "doc = plominoContext\r\nmin = doc.getItem(\"min\")\r\nmax = doc.getItem(\"max\")\r\nreturn \"Validate number between {min} and {max}\".format(min=min, max=max)", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">min</span></p>\n<p><span class=\"plominoFieldClass\">min</span></p>\n<p><span class=\"plominoLabelClass\">max</span></p>\n<p><span class=\"plominoFieldClass\">max</span></p>\n<p><span class=\"plominoLabelClass\">form_error_message</span></p>\n<p><span class=\"plominoFieldClass\">form_error_message</span></p>\n<p><span class=\"plominoFieldClass\">validation_formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Validate number range"
            }, 
            "title": "Validate number range", 
            "type": "PlominoForm"
        }, 
        "macro_field_prepopulate_fromuser": {
            "elements": {
                "data-source": {
                    "id": "data-source", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'plone'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "Plone Users|plone"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Data source", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Data source", 
                    "type": "PlominoField"
                }, 
                "field-name": {
                    "id": "field-name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "from Products.CMFCore.utils import getToolByName\r\ntool = getToolByName(plominoContext, 'portal_memberdata')\r\nids = tool.propertyIds()\r\nreturn [''] + ids", 
                        "separator": null, 
                        "title": "Field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Field name", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "DEFAULT_DATA_SOURCE = 'plone'\r\n\r\nPLONE = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue_if_anonymous = \\\"\\\"\\\"{value_if_anonymous}\\\"\\\"\\\"\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nvalue_if_empty = \\\"\\\"\\\"{value_if_empty}\\\"\\\"\\\"\r\n\r\nfrom Products.CMFCore.utils import getToolByName \r\nmt = getToolByName(plominoContext, 'portal_membership') \r\nif  mt.isAnonymousUser(): \r\n    return value_if_anonymous\r\n\r\nmember = mt.getAuthenticatedMember()\r\n\r\nvalue = member.getProperty(field_name)\r\nreturn value or value_if_empty\r\n\"\"\"\r\n\r\ndoc = plominoContext\r\ndata_source = doc.getItem('data-source', DEFAULT_DATA_SOURCE)\r\nfield_name = doc.getItem('field-name')\r\nvalue_if_empty = doc.getItem('value-if-empty', '')\r\nvalue_if_anonymous = doc.getItem('value-if-anonymous', '')\r\n\r\n# We only handle Plone as a data-source for now\r\nif data_source == 'plone':\r\n    code = PLONE.format(field_name=field_name, value_if_anonymous=value_if_anonymous, value_if_empty=value_if_empty)\r\nelse:\r\n    # We shouldn't get here\r\n    code = ''\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "formula", 
                    "type": "PlominoField"
                }, 
                "value-if-anonymous": {
                    "id": "value-if-anonymous", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Value if anonymous", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Value if anonymous", 
                    "type": "PlominoField"
                }, 
                "value-if-empty": {
                    "id": "value-if-empty", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Value if empty", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Value if empty", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_prepopulate_fromuser", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p>Pre-populate the field with data from the currently logged in user.</p>\n<p><span class=\"plominoLabelClass\">data-source</span></p>\n<p><span class=\"plominoFieldClass\">data-source</span></p>\n<p><span class=\"plominoLabelClass\">field-name</span></p>\n<p><span class=\"plominoFieldClass\">field-name</span></p>\n<p><span class=\"plominoLabelClass\">value-if-empty</span></p>\n<p><span class=\"discreet\">If the field is empty, use the following value.</span></p>\n<p><span class=\"plominoFieldClass\">value-if-empty</span></p>\n<p><span class=\"plominoLabelClass\">value-if-anonymous</span></p>\n<p><span class=\"discreet\">If the user is anonymous, use the following value.</span></p>\n<p><span class=\"plominoFieldClass\">value-if-anonymous</span></p>\n<span class=\"plominoFieldClass\">formula</span>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Pre-populate field from user data"
            }, 
            "title": "Pre-populate field from user data", 
            "type": "PlominoForm"
        }, 
        "macro_field_required_selection": {
            "elements": {
                "field_name": {
                    "id": "field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Fields", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editform.getFormFields()]", 
                                "title": "Select from Fields"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editform.getFormFields()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Selection field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Selection field name", 
                    "type": "PlominoField"
                }, 
                "field_value": {
                    "id": "field_value", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Selection field value", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Selection field value", 
                    "type": "PlominoField"
                }, 
                "form_error_message": {
                    "id": "form_error_message", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Error message", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Error message", 
                    "type": "PlominoField"
                }, 
                "validation_formula": {
                    "id": "validation_formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name')\r\nfield_value_ = doc.getItem('field_value')\r\nform_error_message_ = doc.getItem('form_error_message')\r\ncode = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nvalue = plominoContext.getItem(field_id, '')\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\nfield_result = plominoContext.getItem(field_name)\r\nif field_result == field_value and value == '':\r\n    return \\\"\\\"\\\"{form_error_message}\\\"\\\"\\\"\r\n\"\"\".format(\r\n    field_name=field_name_,\r\n    field_value=field_value_,\r\n    form_error_message=form_error_message_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Validation formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Validation formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_required_selection", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">field_name</span></p>\n<p><span class=\"plominoLabelClass\">field_value</span></p>\n<p><span class=\"plominoFieldClass\">field_value</span></p>\n<p><span class=\"plominoLabelClass\">form_error_message</span></p>\n<p><span class=\"plominoFieldClass\">form_error_message</span></p>\n<p><span class=\"plominoFieldClass\">validation_formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Required field based on selection"
            }, 
            "title": "Required field based on selection", 
            "type": "PlominoForm"
        }, 
        "macro_field_select_fromuser": {
            "elements": {
                "data-source": {
                    "id": "data-source", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'plone'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Plone Users|plone"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Data source", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Data source", 
                    "type": "PlominoField"
                }, 
                "group-filter": {
                    "id": "group-filter", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": null, 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Group filter", 
                        "to_be_indexed": false, 
                        "validation_formula": null, 
                        "widget": "TEXT"
                    }, 
                    "title": "Group filter", 
                    "type": "PlominoField"
                }, 
                "selectionlistformula": {
                    "id": "selectionlistformula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "DEFAULT_DATA_SOURCE = 'plone'\r\n\r\nPLONE = \"\"\"\r\nscript_type, form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\nfield_id, formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\n\r\nfrom Products.CMFCore.utils import getToolByName \r\nmt = getToolByName(plominoContext, 'portal_membership')\r\nmembers = mt.listMembers()\r\nusers = ['|']\r\n# XXX: Filter by group: {group_filter}\r\nusers.extend(['%s|%s' % (member.getProperty('fullname'), member.getId()) for member in members])\r\nreturn users\r\n\"\"\"\r\n\r\ndoc = plominoContext\r\ndata_source = doc.getItem('data-source', DEFAULT_DATA_SOURCE)\r\ngroup_filter = doc.getItem('group-filter')\r\n\r\n# We only handle Plone as a data-source for now\r\nif data_source == 'plone':\r\n    code = PLONE.format(group_filter=group_filter)\r\nelse:\r\n    # We shouldn't get here\r\n    code = ''\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "selectionlistformula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "selectionlistformula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_select_fromuser", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">data-source</span></p>\n<p><span class=\"plominoFieldClass\">data-source</span></p>\n<p><span class=\"plominoLabelClass\">group-filter</span></p>\n<p><span class=\"discreet\">Only show users who are members of this group.</span></p>\n<p><span class=\"plominoFieldClass\">group-filter</span></p>\n<p><span class=\"plominoFieldClass\">selectionlistformula</span></p>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Select user from user data"
            }, 
            "title": "Select user from user data", 
            "type": "PlominoForm"
        }, 
        "macro_field_selection_db_elements": {
            "elements": {
                "element_type": {
                    "id": "element_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": null, 
                        "index_type": "DEFAULT", 
                        "isDynamicField": null, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Forms", 
                            "Fields", 
                            "Views", 
                            "Hidewhens", 
                            "Actions"
                        ], 
                        "selectionlistformula": null, 
                        "separator": null, 
                        "title": "Type of element from the local form or field", 
                        "to_be_indexed": false, 
                        "validation_formula": null, 
                        "widget": "SELECT"
                    }, 
                    "title": "Type of element from the local form or field", 
                    "type": "PlominoField"
                }, 
                "include_other": {
                    "id": "include_other", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "BOOLEAN", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "title": "Include those from other forms", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "CHECKBOX"
                    }, 
                    "title": "Include those from other forms", 
                    "type": "PlominoField"
                }, 
                "include_other_hidewhen": {
                    "id": "include_other_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"element_type\"\"\"\nfield_value = \"\"\"Fields\"\"\"\nfield_result = plominoContext.getItem(field_name)\nresult = str(field_result) == field_value\nif result:\n    return False\nreturn True\n    \n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "==", 
                                "field_name": "element_type", 
                                "field_value": "Fields", 
                                "formula": "\nfield_name = \"\"\"element_type\"\"\"\nfield_value = \"\"\"Fields\"\"\"\nfield_result = plominoContext.getItem(field_name)\nresult = str(field_result) == field_value\nif result:\n    return False\nreturn True\n    ", 
                                "title": "Show when selection matches", 
                                "value_type": "text"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "include_other_hidewhen"
                    }, 
                    "title": "include_other_hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "selectionlistformula": {
                    "id": "selectionlistformula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\ntype_ = doc.getItem('element_type')\r\ninclude_other_ = doc.getItem('include_other', False)\r\ncode = \"\"\"\r\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\r\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\r\nif editpath is None:\r\n    return [] # we aren't being used in a popup\r\neditcontext = plominoContext.restrictedTraverse(editpath)\r\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\r\nctype = editcontext.getPortalTypeName()\r\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\r\neditform = None\r\nif ctype != 'PlominoView':\r\n    if ctype == 'PlominoForm':\r\n        editform = editcontext\r\n    else:\r\n        editform = editcontext.getParentNode()\r\neditdb = editcontext.getParentDatabase()\r\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\r\n\r\ndef item(elm, form_name=''):\r\n    if form_name:\r\n        return '{title} ({id}) from form: {form_name}|{id}'.format(id=elm.id, title=elm.Title(), form_name=form_name)\r\n    return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\r\n\"\"\"\r\n\r\nif type_ == 'Forms':\r\n    return code + \"\"\"\r\nitems = []\r\nfor f in editdb.getForms():\r\n    try:\r\n        if f.getPortalTypeName() == \"PlominoForm\":\r\n            items.append(item(f))\r\n    except AttributeError:\r\n        continue\r\nreturn items\r\n\"\"\"\r\nelif type_ == 'Views':\r\n    return code + \"\"\"\r\nitems = []\r\nfor f in editdb.getViews():\r\n    try:\r\n        if f.getPortalTypeName() == \"PlominoView\":\r\n            items.append(item(f))\r\n    except AttributeError:\r\n        continue\r\nreturn items\r\n\"\"\"\r\nelif type_ == 'Hidewhens':\r\n    return code + \"\"\"\r\nitems = []\r\nfor f in editform.getHidewhenFormulas():\r\n    try:\r\n        if f.getPortalTypeName() == \"PlominoHidewhen\":\r\n            items.append(item(f))\r\n    except AttributeError:\r\n        continue\r\nreturn items\r\n\"\"\"\r\nelif type_ == 'Actions':\r\n    return code + \"\"\"\r\nitems = ['Save (save)|plomino_save','Close (close)|plomino_close']\r\nfor f, method_name in editform.getActions(hide=False):\r\n    try:\r\n        if f.getPortalTypeName() == \"PlominoAction\":\r\n            items.append(item(f))\r\n    except AttributeError:\r\n        continue\r\nreturn items\r\n\"\"\"\r\nelif type_ == 'Fields':\r\n    if include_other_:\r\n        return code + \"\"\"\r\ndef get_fields(form_element, form_name):\r\n    field_items = []\r\n    for this_form in form_element.getFormFields():\r\n        try:\r\n            if this_form.getPortalTypeName() == \"PlominoField\":\r\n                field_items.append(item(this_form, form_name))\r\n        except AttributeError:\r\n            continue\r\n    return field_items\r\n\r\ncurrent_form_name = ''\r\ncurrent_form_items = ['Form ID|Form']\r\nif editform:\r\n    current_form_name = \"{title} ({id})\".format(\r\n        title=editform.Title(),\r\n        id=editform.id)\r\n    current_form_items = get_fields(editform, current_form_name)\r\n\r\nother_form_items = []\r\nfor other_form in editdb.getForms():\r\n    try:\r\n        if other_form.getPortalTypeName() == \"PlominoForm\":\r\n            other_form_name = \"{title} ({id})\".format(\r\n                title=other_form.Title(),\r\n                id=other_form.id)\r\n            if current_form_name != other_form_name:\r\n                other_form_items += get_fields(other_form, other_form_name)\r\n    except AttributeError:\r\n        continue\r\nreturn current_form_items + other_form_items\r\n\"\"\"\r\n    else:\r\n        return code + \"\"\"\r\nitems = []\r\nfor f in editform.getFormFields():\r\n    try:\r\n        if f.getPortalTypeName() == \"PlominoField\":\r\n            items.append(item(f))\r\n    except AttributeError:\r\n        continue\r\nreturn items\r\n\"\"\"\r\nelse:\r\n    return code + 'return []'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "selectionlistformula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "selectionlistformula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_selection_db_elements", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "type_ = plominoDocument.getItem('element_type')\r\nreturn 'Select from {type}'.format(type=type_)", 
                "dynamic_document_title": false, 
                "form_layout": "<p>Prepopulates the selection with elements in this form/field</p>\n<p><span class=\"plominoLabelClass\">element_type</span></p>\n<p><span class=\"plominoFieldClass\">element_type</span></p>\n<p><span class=\"plominoHidewhenClass\">start:include_other_hidewhen</span></p>\n<span class=\"plominoFieldClass\">include_other</span>\n<p><span class=\"plominoLabelClass\">include_other</span><br><br><span class=\"plominoHidewhenClass\">end:include_other_hidewhen</span></p>\n<p><span class=\"plominoFieldClass\">selectionlistformula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Selection of elements from the current form/field"
            }, 
            "title": "Selection of elements from the current form/field", 
            "type": "PlominoForm"
        }, 
        "macro_field_text_autogenerated_id": {
            "elements": {
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"\"\"\r\nimport uuid\r\nreturn uuid.uuid4()\r\n\"\"\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_text_autogenerated_id", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Auto-generated ID"
            }, 
            "title": "Auto-generated ID", 
            "type": "PlominoForm"
        }, 
        "macro_field_text_current_datetime": {
            "elements": {
                "datetime_format": {
                    "id": "datetime_format", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "return '%Y-%m-%d'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Datetime format", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Datetime format", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\ndatetime_format_ = doc.getItem('datetime_format')\r\ncode = \"\"\"\r\ndatetime_format = \\\"\\\"\\\"{datetime_format}\\\"\\\"\\\"\r\nfrom DateTime import DateTime\r\nnow = DateTime()\r\nreturn DateToString(now, datetime_format)\r\n\"\"\".format(\r\n    datetime_format=datetime_format_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_text_current_datetime", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p>Return the current date as text using the following format.</p>\n<p><span class=\"plominoLabelClass\">datetime_format</span></p>\n<span class=\"plominoFieldClass\">datetime_format</span>\n<p> </p>\n<span class=\"plominoFieldClass\">formula</span>\n<p><br><br></p>\n<p><br><br></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Display current date"
            }, 
            "title": "Display current date", 
            "type": "PlominoForm"
        }, 
        "macro_field_text_display": {
            "elements": {
                "datetime_format": {
                    "id": "datetime_format", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Datetime format", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Datetime format", 
                    "type": "PlominoField"
                }, 
                "field_name": {
                    "id": "field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Fields", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editform.getFormFields()]", 
                                "title": "Select from Fields"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editform.getFormFields()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Field name", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name')\r\ndatetime_format_ = doc.getItem('datetime_format')\r\ncode = \"\"\"\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\ndatetime_format = \\\"\\\"\\\"{datetime_format}\\\"\\\"\\\"\r\nfield_result = plominoContext.getItem(field_name)\r\nresult = str(field_result)\r\nif datetime_format:\r\n    try:\r\n        result = DateToString(field_result, format=datetime_format)\r\n    except:\r\n        result = str(field_result)\r\nreturn result\r\n\"\"\".format(\r\n    field_name=field_name_,\r\n    datetime_format=datetime_format_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_text_display", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">field_name</span></p>\n<p><span class=\"plominoLabelClass\">datetime_format</span></p>\n<p><span class=\"form-hint\">This is optional. It is only needed when the field type is datetime and displays in different format.</span></p>\n<p><span class=\"plominoFieldClass\">datetime_format</span></p>\n<p><span class=\"plominoFieldClass\">formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Display other field value"
            }, 
            "title": "Display other field value", 
            "type": "PlominoForm"
        }, 
        "macro_field_text_random_characters": {
            "elements": {
                "character_custom": {
                    "id": "character_custom", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Custom character", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Custom character", 
                    "type": "PlominoField"
                }, 
                "character_prefix": {
                    "id": "character_prefix", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Prefix", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Prefix", 
                    "type": "PlominoField"
                }, 
                "character_size": {
                    "id": "character_size", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": null, 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "INTEGER", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Character size", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Character size", 
                    "type": "PlominoField"
                }, 
                "character_suffix": {
                    "id": "character_suffix", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Suffix", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Suffix", 
                    "type": "PlominoField"
                }, 
                "character_types": {
                    "id": "character_types", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "A-Z|uppercase", 
                            "a-z|lowercase", 
                            "0-9|digits", 
                            "/*_...|punctuation"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Character types", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "CHECKBOX"
                    }, 
                    "title": "Character types", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\ncharacter_size_ = doc.getItem('character_size', 0)\r\ncharacter_types_ = doc.getItem('character_types', [])\r\ncharacter_custom_ = doc.getItem('character_custom', '')\r\ncharacter_prefix_ = doc.getItem('character_prefix', '')\r\ncharacter_suffix_ = doc.getItem('character_suffix', '')\r\n\r\nimport string\r\ntotal_char = ''\r\nif 'uppercase' in character_types_:\r\n    total_char += string.ascii_uppercase\r\nif 'lowercase' in character_types_:\r\n    total_char += string.ascii_lowercase\r\nif 'digits' in character_types_:\r\n    total_char += string.digits\r\nif 'punctuation' in character_types_:\r\n    total_char += string.punctuation\r\nif character_custom_:\r\n    total_char += character_custom_\r\ncode = \"\"\"\r\nimport random\r\ntotal_char = \\\"\\\"\\\"{total_char}\\\"\\\"\\\"\r\ncharacter_prefix = \\\"\\\"\\\"{character_prefix}\\\"\\\"\\\"\r\ncharacter_suffix = \\\"\\\"\\\"{character_suffix}\\\"\\\"\\\"\r\ndef id_generator(\r\n        size={character_size}, \r\n        chars=total_char):\r\n    return ''.join(random.SystemRandom().choice(chars) for _ in range(size))\r\n\r\nreturn character_prefix + id_generator() + character_suffix\r\n\"\"\".format(\r\n    character_size=character_size_,\r\n    total_char=total_char,\r\n    character_prefix=character_prefix_,\r\n    character_suffix=character_suffix_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_text_random_characters", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">character_size</span></p>\n<p><span class=\"plominoFieldClass\">character_size</span></p>\n<p><span class=\"plominoLabelClass\">character_types</span></p>\n<p><span class=\"plominoFieldClass\">character_types</span></p>\n<p><span class=\"plominoLabelClass\">character_custom</span></p>\n<p><span class=\"plominoFieldClass\">character_custom</span></p>\n<p><span class=\"plominoLabelClass\">character_prefix</span></p>\n<p><span class=\"plominoFieldClass\">character_prefix</span></p>\n<p><span class=\"plominoLabelClass\">character_suffix</span></p>\n<p><span class=\"plominoFieldClass\">character_suffix</span></p>\n<p><span class=\"plominoFieldClass\">formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Random characters"
            }, 
            "title": "Random characters", 
            "type": "PlominoForm"
        }, 
        "macro_field_text_template": {
            "elements": {
                "display_variables": {
                    "id": "display_variables", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "DISPLAY", 
                        "field_type": "TEXT", 
                        "formula": "editpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\r\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula')\r\nif editpath is None:\r\n    return [] # we aren't being used in a popup\r\neditcontext = plominoContext.restrictedTraverse(editpath)\r\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula')\r\nctype = editcontext.getPortalTypeName()\r\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula')\r\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\r\neditdb = editcontext.getParentDatabase()\r\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula')\r\n\r\ncontent = ''\r\nform_description = '<p>{form_name} ({form_id})</p>'\r\ntable_start = '<table>'\r\ntable_header = '<tr><th>{form_name}</th><th>{form_id}</th><th></th></tr>'\r\ntable_column = '<tr><th>Field name</th><th>Field ID</th><th>Field type</th></tr>'\r\ntable_field = '<tr><td>{field_name}</td><td>{field_id}</td><td>{field_type}</td></tr>'\r\ntable_end = '</table>'\r\n\r\nnow = Now()\r\nbuilt_in = '''<br />\r\n<p><label>Built in variables</label></p>\r\n<table><tr><th>Description</th><th>ID</th><th>Sample value</th></tr>\r\n<tr><td>Current date</td><td>dt_today</td><td>{dt_today}</td>\r\n<tr><td>Current time</td><td>dt_time</td><td>{dt_time}</td>\r\n</table>'''.format(\r\n    dt_today = now.strftime('%Y%m%d'),\r\n    dt_time = now.strftime('%H%M%S'),\r\n)\r\n\r\n\r\nscript_type, current_form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\ncurrent_field_id, current_formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\n\r\ndef items_content(content_string, objects, type_name):\r\n    for item in objects:\r\n        if type_name == 'action':\r\n            item = item[0]\r\n        item_id = item.id\r\n        if current_field_id == item_id:\r\n            # to avoid maximum recursion depth exceeded\r\n            continue\r\n        item_title = item.Title()\r\n        content_string += table_field.format(\r\n            field_name=item_title,\r\n            field_id=item_id,\r\n            field_type=type_name\r\n        )\r\n    return content_string\r\n\r\nform_obj = editform\r\ncontent += form_description.format(\r\n    form_name=form_obj.id,\r\n    form_id=form_obj.Title(),\r\n)\r\ncontent += table_start\r\nform_id = form_obj.id\r\nform_title = form_obj.Title()\r\ncontent += table_column\r\nform_fields = form_obj.getFormFields(includesubforms=True)\r\ncontent = items_content(content, form_fields, 'field')\r\ncontent += table_end\r\ncontent += built_in\r\n\r\nreturn content", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Variables", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Variables", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "text_template_ = plominoContext.getItem('text_template')\r\ncode = ''\r\nif not text_template_:\r\n    return code\r\n\r\ncode = \"\"\"\r\nif not plominoContext:\r\n    Log(\"*** not plominoContext\", \"macro_field_text_template/formula\")\r\n    return\r\n\r\ndb = plominoContext.getParentDatabase()\r\n\r\nif plominoContext.getId() == 'TEMPDOC' or isDocument(plominoContext):\r\n    Log(\"*** TEMPDOC or document\", \"macro_field_text_template/formula\")\r\n    form_obj = plominoContext.getForm()\r\n    temp_doc = plominoContext\r\nelse:\r\n    Log(\"*** plomino form\", \"macro_field_text_template/formula\")\r\n    form_obj = plominoContext\r\n    temp_doc = plominoContext.getTemporaryDocument()\r\n\r\nscript_type, current_form_id, rest = script_id.split(SCRIPT_ID_DELIMITER, 2)\r\ncurrent_field_id, current_formula = rest.rsplit(SCRIPT_ID_DELIMITER, 1)\r\nLog(\"*** current_field_id %s\" % current_field_id, \"macro_field_text_template/formula\")\r\n\r\ndef item_lambda(obj_variable, doc_variable):\r\n    value_variable = doc_variable.getItem(obj_variable.id, '')\r\n    value_variable = datetime_format_string(obj_variable, value_variable)\r\n    return selection_dict(obj_variable, value_variable)\r\n\r\ndef item_function(obj_variable, doc_variable):\r\n    return lambda : item_lambda(obj_variable, doc_variable)\r\n\r\ndef cache_lambda(obj_variable, doc_variable, form_variable):\r\n    if doc_variable.hasItem(obj_variable.id):\r\n        return doc_variable.getItem(obj_variable.id, '')\r\n\r\n    value_variable = compute_lambda(obj_variable, doc_variable, form_variable)\r\n    doc_variable.setItem(obj_variable.id, value_variable)\r\n    return value_variable\r\n\r\ndef cache_function(obj_variable, doc_variable, form_variable):\r\n    return lambda : cache_lambda(obj_variable, doc_variable, form_variable)\r\n\r\ndef compute_lambda(obj_variable, doc_variable, form_variable):\r\n    value_variable = form_variable.computeFieldValue(obj_variable.id, doc_variable)\r\n    # TODO add selection fuction in compute lambda as well.\r\n    return datetime_format_string(obj_variable, value_variable)\r\n\r\ndef compute_function(obj_variable, doc_variable, form_variable):\r\n    return lambda : compute_lambda(obj_variable, doc_variable, form_variable)\r\n\r\ndef datetime_format_string(item_obj, item_value):\r\n    if item_obj.field_type != 'DATETIME':\r\n        return item_value\r\n    # possible datetime is empty\r\n    if not item_value or isinstance(item_value, basestring):\r\n        return item_value\r\n    if item_obj.format and '%z' in item_obj.format:\r\n        return item_value.ISO8601()\r\n    if db.datetime_format and '%z' in db.datetime_format:\r\n        return item_value.ISO8601()\r\n    return DateToString(item_value, item_obj.format, db)\r\n\r\ndef selection_dict(item_obj, item_value):\r\n    if item_obj.field_type != 'SELECTION':\r\n        return item_value\r\n    item_dict = dict(label='', value='')\r\n    # possible field is empty\r\n    if not item_value:\r\n        return item_dict\r\n    value_list = item_obj.getSelectionList(None)\r\n    for selection_item in value_list:\r\n        label, value = selection_item.split('|')\r\n        if item_value == value:\r\n            item_dict['label'] = label\r\n            item_dict['value'] = value\r\n            break\r\n    return item_dict\r\n\r\nform_fields = form_obj.getFormFields(includesubforms=True)\r\nfields_value = dict([('form_id', form_obj.id)])\r\n\r\n# Inject some extra date fields. Document these in variables.\r\nnow = Now()\r\nfields_value['dt_today'] = now.strftime('%Y%m%d')\r\nfields_value['dt_time'] = now.strftime('%H%M%S')\r\n\r\nfor item in form_fields:\r\n    item_id = item.id\r\n    item_title = item.Title()\r\n    if current_field_id == item_id:\r\n        # to avoid maximum recursion depth exceeded\r\n        continue\r\n    if item.field_mode == 'EDITABLE':\r\n        item_value = item_lambda(item, temp_doc)\r\n    elif item.field_mode == 'COMPUTEDONSAVE' or item.field_mode == 'CREATION':\r\n        item_value = cache_function(item, temp_doc, form_obj)\r\n    else:\r\n        item_value = compute_function(item, temp_doc, form_obj)\r\n    fields_value[item_id] = item_value\r\n\r\nimport pystache\r\ntext_template = \\\"\\\"\\\"{text_template}\\\"\\\"\\\"\r\nparsed_template = pystache.render(text_template, fields_value)\r\nreturn parsed_template\r\n\"\"\".format(text_template=text_template_)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "formula", 
                    "type": "PlominoField"
                }, 
                "text_template": {
                    "id": "text_template", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": "10", 
                        "title": "Template", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXTAREA"
                    }, 
                    "title": "Template", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_text_template", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">display_variables</span></p>\n<p><span class=\"plominoFieldClass\">display_variables</span></p>\n<p><span class=\"plominoLabelClass\">text_template</span></p>\n<p><span class=\"plominoFieldClass\">text_template</span></p>\n<span class=\"plominoFieldClass\">formula</span>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Text template macro"
            }, 
            "title": "Text template macro", 
            "type": "PlominoForm"
        }, 
        "macro_field_validate_invalid": {
            "elements": {
                "invalid_message": {
                    "id": "invalid_message", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Invalid message", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Invalid message", 
                    "type": "PlominoField"
                }, 
                "validation_formula": {
                    "id": "validation_formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\ninvalid_message_ = doc.getItem('invalid_message')\r\ncode = \"\"\"\r\nreturn '''{invalid_message}'''\r\n\"\"\".format(invalid_message=invalid_message_)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Validation formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Validation formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_validate_invalid", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "doc = plominoContext\r\ninvalid_message_ = doc.getItem('invalid_message')\r\ncode = \"\"\"Show invalid message - {invalid_message}\"\"\".format(invalid_message=invalid_message_)\r\nreturn code", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">invalid_message</span></p>\n<p><span class=\"plominoFieldClass\">invalid_message</span> <span class=\"plominoFieldClass\">validation_formula</span></p>\n<p><br><br></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Invalid"
            }, 
            "title": "Invalid", 
            "type": "PlominoForm"
        }, 
        "macro_field_validate_valid": {
            "elements": {
                "validation_formula": {
                    "id": "validation_formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"\"\"\r\nreturn\r\n\"\"\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Validation formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Validation formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_field_validate_valid", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "return 'Validate successful'", 
                "dynamic_document_title": false, 
                "form_layout": "<span class=\"plominoFieldClass\">validation_formula</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Valid"
            }, 
            "title": "Valid", 
            "type": "PlominoForm"
        }, 
        "macro_form_add_author": {
            "elements": {
                "field_name": {
                    "id": "field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "return 'form_author'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Field name", 
                    "type": "PlominoField"
                }, 
                "onsavedocument": {
                    "id": "onsavedocument", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name')\r\ncode = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nmt = db.portal_membership\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nif not mt.isAnonymousUser():\r\n    current_id = plominoContext.getCurrentUserId()\r\n    if current_id:\r\n        plominoContext.setItem(field_name, current_id)\r\n\"\"\".format(field_name=field_name_)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "onSaveDocument", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "onSaveDocument", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_form_add_author", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p>This macro will add this current log-in member that edit this form as the author.</p>\n<p><span class=\"plominoLabelClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">onsavedocument</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Add current site member as author"
            }, 
            "title": "Add current site member as author", 
            "type": "PlominoForm"
        }, 
        "macro_form_add_saved_date": {
            "elements": {
                "field_name": {
                    "id": "field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "return 'last_saved_date'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Field name", 
                    "type": "PlominoField"
                }, 
                "onsavedocument": {
                    "id": "onsavedocument", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name')\r\ncode = \"\"\"\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nplominoContext.setItem(field_name, Now())\r\n\"\"\".format(field_name=field_name_)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "onSaveDocument", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "onSaveDocument", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_form_add_saved_date", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p>This macro will add saved date to the document.</p>\n<p><span class=\"plominoLabelClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">onsavedocument</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Add saved date"
            }, 
            "title": "Add saved date", 
            "type": "PlominoForm"
        }, 
        "macro_form_message": {
            "elements": {
                "message": {
                    "id": "message", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Message", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Message", 
                    "type": "PlominoField"
                }, 
                "message_type": {
                    "id": "message_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Info|info", 
                            "Error|error"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Message type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Message type", 
                    "type": "PlominoField"
                }, 
                "onsavedocument": {
                    "id": "onsavedocument", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nmessage_type_ = doc.getItem('message_type')\r\nmessage_ = doc.getItem('message')\r\ncode = ''\r\nif message_type_ == 'info':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nmessage = \\\"\\\"\\\"{message}\\\"\\\"\\\"\r\ndb.writeMessageOnPage(message, req)\r\n    \"\"\".format(\r\n    message=message_\r\n)\r\nelif redirect_type_ == 'error':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nmessage = \\\"\\\"\\\"{message}\\\"\\\"\\\"\r\ndb.writeMessageOnPage(message, req, error=True)\r\n    \"\"\".format(\r\n    message=message_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "onSaveDocument", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "onSaveDocument", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_form_message", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">message_type</span></p>\n<p><span class=\"plominoFieldClass\">message_type</span></p>\n<p><span class=\"plominoLabelClass\">message</span></p>\n<p><span class=\"plominoFieldClass\">message</span></p>\n<p><span class=\"plominoFieldClass\">onsavedocument</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Show message"
            }, 
            "title": "Show message", 
            "type": "PlominoForm"
        }, 
        "macro_form_redirect_onload": {
            "elements": {
                "beforecreatedocument": {
                    "id": "beforecreatedocument", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nredirect_type_ = doc.getItem('redirect_type')\r\nform_redirect_ = doc.getItem('form_redirect')\r\nview_redirect_ = doc.getItem('view_redirect')\r\nurl_redirect_ = doc.getItem('url_redirect')\r\nrequest_value_ = doc.getItem('request_value')\r\ncode = ''\r\nif redirect_type_ == 'form':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nform_redirect = \\\"\\\"\\\"{form_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s/%s' % (db.absolute_url(), form_redirect)\r\nif '{request_value}' in req:\r\n    req.RESPONSE.redirect(targeturl)\r\n    \"\"\".format(\r\n    form_redirect=form_redirect_,\r\n    request_value=request_value_\r\n)\r\nelif redirect_type_ == 'view':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nview_redirect = \\\"\\\"\\\"{view_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s/%s' % (db.absolute_url(), view_redirect)\r\nif '{request_value}' in req:\r\n    req.RESPONSE.redirect(targeturl)\r\n    \"\"\".format(\r\n    view_redirect=view_redirect_,\r\n    request_value=request_value_\r\n)\r\nelif redirect_type_ == 'url':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nurl_redirect = \\\"\\\"\\\"{url_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s' % url_redirect\r\nif '{request_value}' in req:\r\n    req.RESPONSE.redirect(targeturl)\r\n    \"\"\".format(\r\n    url_redirect=url_redirect_,\r\n    request_value=request_value_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "beforeCreateDocument", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "beforeCreateDocument", 
                    "type": "PlominoField"
                }, 
                "form_hidewhen": {
                    "id": "form_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\r\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"form\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "form", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"form\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "Form hidewhen"
                    }, 
                    "title": "Form hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "form_redirect": {
                    "id": "form_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Forms", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getForms()]", 
                                "title": "Select from Forms"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "\n### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getForms()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Form redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Form redirect", 
                    "type": "PlominoField"
                }, 
                "redirect_type": {
                    "id": "redirect_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "Form|form", 
                            "View|view", 
                            "URL|url"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Redirect type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Redirect type", 
                    "type": "PlominoField"
                }, 
                "request_value": {
                    "id": "request_value", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Actions", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f, method_name in editform.getActions(hide=False)]", 
                                "title": "Select from Actions"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f, method_name in editform.getActions(hide=False)]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Submit button", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Submit button", 
                    "type": "PlominoField"
                }, 
                "url_hidewhen": {
                    "id": "url_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"url\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "url", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"url\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "URL hidewhen"
                    }, 
                    "title": "URL hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "url_redirect": {
                    "id": "url_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "URL redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "URL redirect", 
                    "type": "PlominoField"
                }, 
                "view_hidewhen": {
                    "id": "view_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"view\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "view", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"view\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "View hidewhen"
                    }, 
                    "title": "View hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "view_redirect": {
                    "id": "view_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Views", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getViews()]", 
                                "title": "Select from Views"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "\n### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getViews()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "View redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "View redirect", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_form_redirect_onload", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">redirect_type</span></p>\n<p><span class=\"plominoFieldClass\">redirect_type</span></p>\n<p><span class=\"plominoHidewhenClass\">start:form_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">form_redirect</span></p>\n<p><span class=\"plominoFieldClass\">form_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:form_hidewhen</span></p>\n<p><span class=\"plominoHidewhenClass\">start:view_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">view_redirect</span></p>\n<p><span class=\"plominoFieldClass\">view_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:view_hidewhen</span></p>\n<p><span class=\"plominoHidewhenClass\">start:url_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">url_redirect</span></p>\n<p><span class=\"plominoFieldClass\">url_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:url_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">request_value</span></p>\n<p><span class=\"plominoFieldClass\">request_value</span></p>\n<p><span class=\"plominoFieldClass\">beforecreatedocument</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Redirect in form on load"
            }, 
            "title": "Redirect in form on load", 
            "type": "PlominoForm"
        }, 
        "macro_form_redirect_onsave": {
            "elements": {
                "form_hidewhen": {
                    "id": "form_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\r\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"form\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "form", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"form\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "Form hidewhen"
                    }, 
                    "title": "Form hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "form_redirect": {
                    "id": "form_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Forms", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getForms()]", 
                                "title": "Select from Forms"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "\n### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getForms()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Form redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Form redirect", 
                    "type": "PlominoField"
                }, 
                "onsavedocument": {
                    "id": "onsavedocument", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nredirect_type_ = doc.getItem('redirect_type')\r\nform_redirect_ = doc.getItem('form_redirect')\r\nview_redirect_ = doc.getItem('view_redirect')\r\nurl_redirect_ = doc.getItem('url_redirect')\r\ncode = ''\r\nif redirect_type_ == 'form':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nform_redirect = \\\"\\\"\\\"{form_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s/%s' % (db.absolute_url(), form_redirect)\r\nreturn targeturl\r\n    \"\"\".format(\r\n    form_redirect=form_redirect_\r\n)\r\nelif redirect_type_ == 'view':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nview_redirect = \\\"\\\"\\\"{view_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s/%s' % (db.absolute_url(), view_redirect)\r\nreturn targeturl\r\n    \"\"\".format(\r\n    view_redirect=view_redirect_\r\n)\r\nelif redirect_type_ == 'url':\r\n    code = \"\"\"\r\ndb = plominoContext.getParentDatabase()\r\nreq = getattr(plominoContext, 'REQUEST')\r\nurl_redirect = \\\"\\\"\\\"{url_redirect}\\\"\\\"\\\"\r\ntargeturl = '%s' % url_redirect\r\nreturn targeturl\r\n    \"\"\".format(\r\n    url_redirect=url_redirect_\r\n)\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "onSaveDocument", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "onSaveDocument", 
                    "type": "PlominoField"
                }, 
                "redirect_type": {
                    "id": "redirect_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "Form|form", 
                            "View|view", 
                            "URL|url"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Redirect type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Redirect type", 
                    "type": "PlominoField"
                }, 
                "url_hidewhen": {
                    "id": "url_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"url\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "url", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"url\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "URL hidewhen"
                    }, 
                    "title": "URL hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "url_redirect": {
                    "id": "url_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "URL redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "URL redirect", 
                    "type": "PlominoField"
                }, 
                "view_hidewhen": {
                    "id": "view_hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "False\n### START macro_hidewhen_selection_1 ###\n\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"view\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n\n### END macro_hidewhen_selection_1 ###", 
                        "helpers": [
                            {
                                "Form": "macro_hidewhen_selection", 
                                "_macro_id_": "macro_hidewhen_selection_1", 
                                "field_compare": "!=", 
                                "field_name": "redirect_type", 
                                "field_value": "view", 
                                "formula": "\nfield_name = \"\"\"redirect_type\"\"\"\nfield_value = \"\"\"view\"\"\"\nfield_result = plominoContext.getItem(field_name)\nreturn str(field_result) != field_value\n", 
                                "title": "Hidewhen based on picking from a selection"
                            }
                        ], 
                        "isDynamicHidewhen": true, 
                        "title": "View hidewhen"
                    }, 
                    "title": "View hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "view_redirect": {
                    "id": "view_redirect", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Views", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getViews()]", 
                                "title": "Select from Views"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "\n### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editdb.getViews()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "View redirect", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "View redirect", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_form_redirect_onsave", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">redirect_type</span></p>\n<p><span class=\"plominoFieldClass\">redirect_type</span></p>\n<p><span class=\"plominoHidewhenClass\">start:form_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">form_redirect</span></p>\n<p><span class=\"plominoFieldClass\">form_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:form_hidewhen</span></p>\n<p><span class=\"plominoHidewhenClass\">start:view_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">view_redirect</span></p>\n<p><span class=\"plominoFieldClass\">view_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:view_hidewhen</span></p>\n<p><span class=\"plominoHidewhenClass\">start:url_hidewhen</span></p>\n<p><span class=\"plominoLabelClass\">url_redirect</span></p>\n<p><span class=\"plominoFieldClass\">url_redirect</span></p>\n<p><span class=\"plominoHidewhenClass\">end:url_hidewhen</span></p>\n<p><span class=\"plominoFieldClass\">onsavedocument</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Redirect in form on save"
            }, 
            "title": "Redirect in form on save", 
            "type": "PlominoForm"
        }, 
        "macro_form_rest_submission": {
            "elements": {
                "api-url": {
                    "id": "api-url", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "API URL", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "API URL", 
                    "type": "PlominoField"
                }, 
                "auth-basic-hidewhen": {
                    "id": "auth-basic-hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "AUTH_TYPE = 'basic'\r\n#AUTH_TYPE = 'oauth2'\r\n\r\nauth_type = plominoContext.getItem('authentication-type')\r\nif auth_type == AUTH_TYPE:\r\n    return False\r\nreturn True", 
                        "helpers": [], 
                        "isDynamicHidewhen": true, 
                        "title": "Basic Auth Hidewhen"
                    }, 
                    "title": "Basic Auth Hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "auth-basic-password": {
                    "id": "auth-basic-password", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Basic Auth Password", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Basic Auth Password", 
                    "type": "PlominoField"
                }, 
                "auth-basic-username": {
                    "id": "auth-basic-username", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Basic Auth Username", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Basic Auth Username", 
                    "type": "PlominoField"
                }, 
                "auth-oauth2-hidewhen": {
                    "id": "auth-oauth2-hidewhen", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "formula": "#AUTH_TYPE = 'basic'\r\nAUTH_TYPE = 'oauth2'\r\n\r\nauth_type = plominoContext.getItem('authentication-type')\r\nif auth_type == AUTH_TYPE:\r\n    return False\r\nreturn True", 
                        "helpers": [], 
                        "isDynamicHidewhen": true, 
                        "title": "OAuth2 Auth Hidewhen"
                    }, 
                    "title": "OAuth2 Auth Hidewhen", 
                    "type": "PlominoHidewhen"
                }, 
                "auth-oauth2-token": {
                    "id": "auth-oauth2-token", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": null, 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "OAuth2 Auth Token", 
                        "to_be_indexed": false, 
                        "validation_formula": null, 
                        "widget": "TEXT"
                    }, 
                    "title": "OAuth2 Auth Token", 
                    "type": "PlominoField"
                }, 
                "auth-oauth2-url": {
                    "id": "auth-oauth2-url", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "OAuth2 Auth URL", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "OAuth2 Auth URL", 
                    "type": "PlominoField"
                }, 
                "authentication-type": {
                    "id": "authentication-type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'none'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": true, 
                        "read_template": null, 
                        "selectionlist": [
                            "None|none", 
                            "Basic Authentication|basic", 
                            "OAuth2|oauth2"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Authentication Type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Authentication Type", 
                    "type": "PlominoField"
                }, 
                "redirect-url": {
                    "id": "redirect-url", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": null, 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Redirect URL", 
                        "to_be_indexed": false, 
                        "validation_formula": null, 
                        "widget": "TEXT"
                    }, 
                    "title": "Redirect URL", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_form_rest_submission", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">api-url</span></p>\n<p><span class=\"discreet\">Enter the URL of the REST API.</span></p>\n<p><span class=\"plominoFieldClass\">api-url</span></p>\n<p><span class=\"plominoLabelClass\">redirect-url</span></p>\n<p><span class=\"discreet\">Where to redirect users after they have submitted the form.</span></p>\n<span class=\"plominoFieldClass\">redirect-url</span>\n<p> </p>\n<p><span class=\"plominoLabelClass\">authentication-type</span></p>\n<p><span class=\"discreet\">If the REST API requires authentication, select the authentication type below.</span></p>\n<p><span class=\"plominoFieldClass\">authentication-type</span></p>\n<p><span class=\"plominoHidewhenClass\">start:auth-basic-hidewhen</span></p>\n<h4>Basic Authentication Settings</h4>\n<span class=\"plominoLabelClass\">auth-basic-username:Username</span>\n<p><span class=\"plominoFieldClass\">auth-basic-username</span></p>\n<span class=\"plominoLabelClass\">auth-basic-password:Password</span>\n<p><span class=\"plominoFieldClass\">auth-basic-password</span></p>\n<p><span class=\"plominoHidewhenClass\">end:auth-basic-hidewhen</span></p>\n<p><span class=\"plominoHidewhenClass\">start:auth-oauth2-hidewhen</span></p>\n<h4>OAuth2 Settings</h4>\n<span class=\"plominoLabelClass\">auth-oauth2-token:Auth Token</span>\n<p><span class=\"plominoFieldClass\">auth-oauth2-token</span></p>\n<span class=\"plominoLabelClass\">auth-oauth2-url:Auth URL</span>\n<p><span class=\"plominoFieldClass\">auth-oauth2-url</span></p>\n<p><span class=\"plominoHidewhenClass\">end:auth-oauth2-hidewhen</span></p>\n<p> </p>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "REST API Submission"
            }, 
            "title": "REST API Submission", 
            "type": "PlominoForm"
        }, 
        "macro_hidewhen_hide": {
            "elements": {
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"\"\"\r\nreturn True\r\n\"\"\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_hidewhen_hide", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<span class=\"plominoFieldClass\">formula</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Hide"
            }, 
            "title": "Hide", 
            "type": "PlominoForm"
        }, 
        "macro_hidewhen_show": {
            "elements": {
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"\"\"\r\nreturn False\r\n\"\"\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_hidewhen_show", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<span class=\"plominoFieldClass\">formula</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Show"
            }, 
            "title": "Show", 
            "type": "PlominoForm"
        }, 
        "macro_view_exclude": {
            "elements": {
                "selection_formula": {
                    "id": "selection_formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"\"\"\r\nreturn False\r\n\"\"\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Selection Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Selection Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_view_exclude", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p>Combine this with an \"if\" macro to exclude those documents that match from your View</p>\n<span class=\"plominoFieldClass\">selection_formula</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Exclude"
            }, 
            "title": "Exclude", 
            "type": "PlominoForm"
        }, 
        "macro_view_include": {
            "elements": {
                "selection_formula": {
                    "id": "selection_formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "code = \"\"\"\r\nreturn True\r\n\"\"\"\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Selection Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Selection Formula", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_view_include", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p>Combine this with an \"if\" macro to include those documents that match from your View</p>\n<span class=\"plominoFieldClass\">selection_formula</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Include"
            }, 
            "title": "Include", 
            "type": "PlominoForm"
        }, 
        "macro_view_selection_criterion": {
            "elements": {
                "field_compare": {
                    "id": "field_compare", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Contains|in", 
                            "Does not contain|not in"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Comparison", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Comparison", 
                    "type": "PlominoField"
                }, 
                "field_name": {
                    "id": "field_name", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [
                            {
                                "Form": "macro_field_selection_db_elements", 
                                "_macro_id_": "macro_field_selection_db_elements_1", 
                                "element_type": "Fields", 
                                "selectionlistformula": "\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editform.getFormFields()]", 
                                "title": "Select from Fields"
                            }
                        ], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": null, 
                        "selectionlistformula": "\n### START macro_field_selection_db_elements_1 ###\n\neditpath = plominoContext.REQUEST.get('Plomino_Macro_Context')\nLog('editpath %s' % editpath, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nif editpath is None:\n    return [] # we aren't being used in a popup\neditcontext = plominoContext.restrictedTraverse(editpath)\nLog('editcontext %s' % editcontext, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\nctype = editcontext.getPortalTypeName()\nLog('ctype %s' % ctype, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\neditform = editcontext if ctype == 'PlominoForm' else editcontext.getParentNode()\neditdb = editcontext.getParentDatabase()\nLog('editdb %s' % editdb, 'macro_field_selection_db_elements/selectionlistformula', severity='debug')\n\ndef item(elm):\n  return '{title} ({id})|{id}'.format(id=elm.id, title=elm.Title())\nreturn [item(f) for f in editform.getFormFields()]\n### END macro_field_selection_db_elements_1 ###", 
                        "separator": null, 
                        "title": "Field name", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Field name", 
                    "type": "PlominoField"
                }, 
                "field_value": {
                    "id": "field_value", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Field value", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "TEXT"
                    }, 
                    "title": "Field value", 
                    "type": "PlominoField"
                }, 
                "formula": {
                    "id": "formula", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "COMPUTEDONSAVE", 
                        "field_type": "TEXT", 
                        "formula": "doc = plominoContext\r\nfield_name_ = doc.getItem('field_name')\r\nfield_compare_ = doc.getItem('field_compare')\r\nfield_value_ = doc.getItem('field_value')\r\nvalue_type_ = doc.getItem('value_type')\r\ncode = ''\r\nif value_type_ == 'text':\r\n    code = \"\"\"\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\nfield_result = plominoContext.getItem(field_name)\r\nform = plominoContext.getForm()\r\nfield = getattr(form, field_name)\r\nif field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n    field_result = form.computeFieldValue(field_name, plominoContext)\r\nresult = field_value {field_compare} str(field_result)\r\nreturn result:\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_compare=field_compare_,\r\n        field_value=field_value_\r\n    )\r\nelif value_type_ == 'regex' and field_compare_ == 'in':\r\n    code = \"\"\"\r\nimport re\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\nfield_result = plominoContext.getItem(field_name)\r\nform = plominoContext.getForm()\r\nfield = getattr(form, field_name)\r\nif field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n    field_result = form.computeFieldValue(field_name, plominoContext)\r\nresult = re.search(field_value, field_result)\r\nreturn result:\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_value=field_value_\r\n    )\r\nelif value_type_ == 'regex' and field_compare_ == 'not in':\r\n    code = \"\"\"\r\nimport re\r\nfield_name = \\\"\\\"\\\"{field_name}\\\"\\\"\\\"\r\nfield_value = \\\"\\\"\\\"{field_value}\\\"\\\"\\\"\r\nfield_result = plominoContext.getItem(field_name)\r\nform = plominoContext.getForm()\r\nfield = getattr(form, field_name)\r\nif field.field_mode in [\"COMPUTED\",\"COMPUTEDONSAVE\"]:\r\n    field_result = form.computeFieldValue(field_name, plominoContext)\r\nresult = re.search(field_value, field_result)\r\nreturn not result:\r\n    \"\"\".format(\r\n        field_name=field_name_,\r\n        field_value=field_value_\r\n    )\r\nreturn code", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Formula", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "HIDDEN"
                    }, 
                    "title": "Formula", 
                    "type": "PlominoField"
                }, 
                "value_type": {
                    "id": "value_type", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "return 'text'", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Text|text", 
                            "Regular expression|regex"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Value type", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Value type", 
                    "type": "PlominoField"
                }
            }, 
            "id": "macro_view_selection_criterion", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">field_name</span></p>\n<p><span class=\"plominoFieldClass\">field_name</span></p>\n<p><span class=\"plominoLabelClass\">field_compare</span></p>\n<p><span class=\"plominoFieldClass\">field_compare</span></p>\n<p><span class=\"plominoLabelClass\">field_value</span></p>\n<p><span class=\"plominoFieldClass\">field_value</span></p>\n<p><span class=\"plominoLabelClass\">value_type</span></p>\n<p><span class=\"plominoFieldClass\">value_type</span></p>\n<p><span class=\"plominoFieldClass\">formula</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Document selection criterion in view"
            }, 
            "title": "Document selection criterion in view", 
            "type": "PlominoForm"
        }, 
        "resources": {}, 
        "template_checkbox": {
            "elements": {
                "checkbox": {
                    "id": "checkbox", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Option A|a", 
                            "Option B|b", 
                            "Option C|c"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Untitled", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "CHECKBOX"
                    }, 
                    "title": "Untitled", 
                    "type": "PlominoField"
                }
            }, 
            "id": "template_checkbox", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">checkbox</span></p>\n<span class=\"plominoFieldClass\">checkbox</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Checkboxes"
            }, 
            "title": "Checkboxes", 
            "type": "PlominoForm"
        }, 
        "template_dropdown": {
            "elements": {
                "dropdown": {
                    "id": "dropdown", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Option A|a", 
                            "Option B|b", 
                            "Option C|c"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Untitled", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "SELECT"
                    }, 
                    "title": "Untitled", 
                    "type": "PlominoField"
                }
            }, 
            "id": "template_dropdown", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">dropdown</span></p>\n<p><span class=\"plominoFieldClass\">dropdown</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Dropdown"
            }, 
            "title": "Dropdown", 
            "type": "PlominoForm"
        }, 
        "template_float": {
            "elements": {
                "float": {
                    "id": "float", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": null, 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "FLOAT", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Untitled", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Untitled", 
                    "type": "PlominoField"
                }
            }, 
            "id": "template_float", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">float</span></p>\n<span class=\"plominoFieldClass\">float</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Float number"
            }, 
            "title": "Float number", 
            "type": "PlominoForm"
        }, 
        "template_integer": {
            "elements": {
                "integer": {
                    "id": "integer", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": null, 
                        "formula": null, 
                        "helpers": [], 
                        "html_attributes_formula": null, 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "INTEGER", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Untitled", 
                        "to_be_indexed": false, 
                        "validation_formula": null
                    }, 
                    "title": "Untitled", 
                    "type": "PlominoField"
                }
            }, 
            "id": "template_integer", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">integer</span></p>\n<span class=\"plominoFieldClass\">integer</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Whole number"
            }, 
            "title": "Whole number", 
            "type": "PlominoForm"
        }, 
        "template_percentage": {
            "elements": {
                "percentage": {
                    "id": "percentage", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": "%1.2f", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "DECIMAL", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Untitled", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Untitled", 
                    "type": "PlominoField"
                }
            }, 
            "id": "template_percentage", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">percentage</span></p>\n<p><span class=\"plominoFieldClass\">percentage</span> %</p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Percentage"
            }, 
            "title": "Percentage", 
            "type": "PlominoForm"
        }, 
        "template_price": {
            "elements": {
                "price": {
                    "id": "price", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "NUMBER", 
                        "format": "%1.2f", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "number_type": "DECIMAL", 
                        "read_template": null, 
                        "size": null, 
                        "title": "Untitled", 
                        "to_be_indexed": false, 
                        "validation_formula": ""
                    }, 
                    "title": "Untitled", 
                    "type": "PlominoField"
                }
            }, 
            "id": "template_price", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">price</span></p>\n<p>$ <span class=\"plominoFieldClass\">price</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Price"
            }, 
            "title": "Price", 
            "type": "PlominoForm"
        }, 
        "template_radio": {
            "elements": {
                "radio": {
                    "id": "radio", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "SELECTION", 
                        "formula": "", 
                        "helpers": [], 
                        "html_attributes_formula": "", 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "read_template": null, 
                        "selectionlist": [
                            "Option A|a", 
                            "Option B|b", 
                            "Option C|c"
                        ], 
                        "selectionlistformula": "", 
                        "separator": null, 
                        "title": "Untitled", 
                        "to_be_indexed": false, 
                        "validation_formula": "", 
                        "widget": "RADIO"
                    }, 
                    "title": "Untitled", 
                    "type": "PlominoField"
                }
            }, 
            "id": "template_radio", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">radio</span></p>\n<span class=\"plominoFieldClass\">radio</span>\n<p> </p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Radio buttons"
            }, 
            "title": "Radio buttons", 
            "type": "PlominoForm"
        }, 
        "template_text": {
            "elements": {
                "text": {
                    "id": "text", 
                    "params": {
                        "ajax_include_head": null, 
                        "ajax_load": null, 
                        "description": "", 
                        "edit_template": null, 
                        "field_mode": "EDITABLE", 
                        "field_type": "TEXT", 
                        "formula": null, 
                        "helpers": [], 
                        "html_attributes_formula": null, 
                        "index_type": "DEFAULT", 
                        "isDynamicField": false, 
                        "mandatory": false, 
                        "preserve_carriage_returns": false, 
                        "read_template": null, 
                        "size": null, 
                        "title": "Untitled", 
                        "to_be_indexed": false, 
                        "validation_formula": null, 
                        "widget": "TEXT"
                    }, 
                    "title": "Untitled", 
                    "type": "PlominoField"
                }
            }, 
            "id": "template_text", 
            "params": {
                "ajax_include_head": null, 
                "ajax_load": null, 
                "beforeCreateDocument": "", 
                "beforeSaveDocument": "", 
                "description": "", 
                "document_id": "", 
                "document_title": "", 
                "dynamic_document_title": false, 
                "form_layout": "<p><span class=\"plominoLabelClass\">text</span></p>\n<p><span class=\"plominoFieldClass\">text</span></p>", 
                "form_method": "Auto", 
                "helpers": [], 
                "hide_default_actions": false, 
                "isMulti": false, 
                "isPage": false, 
                "isSearchForm": false, 
                "onCreateDocument": "", 
                "onDeleteDocument": "", 
                "onDisplay": "", 
                "onOpenDocument": "", 
                "onSaveDocument": "", 
                "onSearch": "", 
                "resources_css": null, 
                "resources_js": null, 
                "search_formula": "", 
                "search_view": null, 
                "store_dynamic_document_title": false, 
                "title": "Text"
            }, 
            "title": "Text", 
            "type": "PlominoForm"
        }
    }, 
    "id": "macros"
}